{"version":3,"sources":["docs/js/glsl-canvas.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","global","factory","this","support","self","Symbol","Blob","viewClasses","isArrayBufferView","ArrayBuffer","isView","obj","indexOf","Object","prototype","toString","normalizeName","name","String","test","TypeError","toLowerCase","normalizeValue","value","iteratorFor","items","iterator","next","shift","done","undefined","Headers","headers","map","forEach","append","Array","isArray","header","getOwnPropertyNames","consumed","body","bodyUsed","Promise","reject","fileReaderReady","reader","resolve","onload","result","onerror","error","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","bufferClone","buf","slice","view","Uint8Array","byteLength","set","buffer","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","DataView","_bodyArrayBuffer","get","type","rejected","arrayBuffer","then","text","readAsText","chars","fromCharCode","join","readArrayBufferAsText","formData","decode","json","JSON","parse","oldValue","has","hasOwnProperty","callback","thisArg","keys","push","values","entries","methods","Request","input","options","method","upcased","url","credentials","mode","signal","toUpperCase","referrer","form","trim","split","bytes","replace","decodeURIComponent","Response","bodyInit","status","ok","statusText","clone","response","redirectStatuses","redirect","RangeError","location","DOMException","err","message","stack","create","constructor","fetch","init","request","aborted","xhr","XMLHttpRequest","abortXhr","abort","rawHeaders","getAllResponseHeaders","line","parts","key","responseURL","responseText","ontimeout","onabort","open","withCredentials","responseType","setRequestHeader","addEventListener","onreadystatechange","readyState","removeEventListener","send","polyfill","defineProperty","define","amd","WHATWGFetch","2","_possibleConstructorReturn","_typeof","ReferenceError","_assertThisInitialized","_wrapNativeSuper","Class","_cache","Map","fn","Function","Wrapper","_construct","arguments","_getPrototypeOf","enumerable","writable","configurable","_setPrototypeOf","Parent","args","Reflect","construct","sham","Proxy","Date","isNativeReflectConstruct","apply","instance","bind","setPrototypeOf","__proto__","getPrototypeOf","_classCallCheck","Constructor","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","__importDefault","mod","__esModule","default","v","context_1","Buffer","gl","BW","BH","index","getExtension","activeTexture","TEXTURE0","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","FLOAT","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","createFramebuffer","bindFramebuffer","FRAMEBUFFER","minW","Math","min","minH","pixels","Float32Array","readPixels","newIndex","newTexture","texSubImage2D","newBuffer","deleteTexture","IOBuffer","vertexString","fragmentString","isValid","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","output","deleteShader","useProgram","viewport","framebufferTexture2D","COLOR_ATTACHMENT0","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","console","log","drawArrays","TRIANGLES","temp","resize","deleteProgram","Buffers","_Map","subClass","superClass","_inherits","size","buffers","count","matches","regexp","exec","drawingBufferWidth","drawingBufferHeight","./context","3","ContextError","ContextVertexBuffers","Context","canvas","attributes","errorCallback","handleError","errorCode","html","container","parentNode","innerHTML","concat","WebGLRenderingContext","BrowserSupport","context","getContext","Other","names","source","offset","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","lastError","getShaderInfoLog","shaders","locations","attachShader","_i","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","vertexBuffers","texcoordIndex","getAttribLocation","texcoord","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","positionIndex","position","4","_toConsumableArray","arr","arr2","_arrayWithoutHoles","iter","from","_iterableToArray","_nonIterableSpread","__importStar","k","buffers_1","listener_subscriber_1","textures_1","uniforms_1","GlslCanvasOptions","GlslCanvasTimer","delay","current","delta","paused","start","previous","performance","now","GlslCanvas","_listener_subscriber_","_this","contextOptions","dirty","animated","nDelta","nTime","nDate","nMouse","textureList","textures","uniforms","mouse","x","y","valid","visible","width","clientWidth","height","clientHeight","rect","getBoundingClientRect","tryGetContext","onError","pixelRatio","window","devicePixelRatio","style","backgroundColor","getShaders","success","load","addListeners","loop","_this2","urls","hasAttribute","getAttribute","all","_this3","scroll","mousemove","clientX","pageX","clientY","pageY","click","toggle","time","checkRender","requestAnimationFrame","document","pause","getBuffers","createVertexBuffers","createUniforms","trigger","_this4","vertex","fragment","timer","extension","query","createQueryEXT","wasValid","render","beginQueryEXT","TIME_ELAPSED_EXT","endQueryEXT","waitForTest","available","getQueryObjectEXT","QUERY_RESULT_AVAILABLE_EXT","disjoint","getParameter","GPU_DISJOINT_EXT","timeElapsedMs","QUERY_RESULT_EXT","destroy","_uniforms_1$default","_len","_key","uniform","parseUniform","loadTexture","_this5","setUniform","classList","add","play","remove","top","innerHeight","documentElement","W","H","floor","isVisible","sizeDidChanged","isAnimated","isDirty","_this6","hasDelta","match","hasTime","hasDate","hasMouse","hasTextures","parseTextures","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","_this7","search","lines","ext","pop","TextureExtensions","_this8","createOrUpdate","_this9","update","left","right","bottom","MX","MY","tryUpdate","_this10","updateUniforms","b","canvases","getElementsByClassName","filter","HTMLCanvasElement","glslCanvases","./buffers","./listener.subscriber","./textures","./uniforms","whatwg-fetch","5","Listener","event","ListenerSubscriber","listeners","Set","listener","delete","clear","data","6","TextureSourceType","TextureFilteringType","TextureImageExtensions","TextureVideoExtensions","TextureData","TextureOptions","Texture","powerOf2","setData","filtering","Linear","setUrl","element","setElement","sourceType","Url","assign","isVideo","src","createElement","setAttribute","autoplay","muted","Image","isSafari","crossOrigin","originalElement","querySelector","HTMLImageElement","HTMLVideoElement","Element","video","setFiltering","stringify","Data","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","naturalWidth","naturalHeight","UNSIGNED_BYTE","videoWidth","videoHeight","imageBuffer","isPowerOf2","MipMap","wrapS","repeat","REPEAT","wrapT","LINEAR_MIPMAP_LINEAR","LINEAR","generateMipmap","Nearest","navigator","userAgent","urlElementOrData","getTextureOptions","MAX_TEXTURE_SIZE","isTextureUrl","Textures","textureOptions","reduce","flag","7","Uniform","getUniformLocation","UniformTexture","_Uniform","Uniforms","_len2","_key2","_len3","_key3","_len4","_key4","array","_len5","_key5","isTexture","isArrayOfNumbers","_u","prefix"],"mappings":"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","file":"glsl-canvas.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (factory((global.WHATWGFetch = {})));\n}(this, (function (exports) { 'use strict';\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"./context\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var context_1 = __importDefault(require(\"./context\"));\n\n  var Buffer =\n  /*#__PURE__*/\n  function () {\n    function Buffer(gl, BW, BH, index) {\n      _classCallCheck(this, Buffer);\n\n      gl.getExtension('OES_texture_float');\n      gl.activeTexture(gl.TEXTURE0 + index);\n      var texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, BW, BH, 0, gl.RGBA, gl.FLOAT, null);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      var buffer = gl.createFramebuffer();\n      this.texture = texture;\n      this.buffer = buffer;\n      this.BW = BW;\n      this.BH = BH;\n      this.index = index;\n    }\n\n    _createClass(Buffer, [{\n      key: \"resize\",\n      value: function resize(gl, BW, BH) {\n        var buffer = this.buffer;\n        var texture = this.texture;\n        var index = this.index;\n        gl.bindFramebuffer(gl.FRAMEBUFFER, buffer);\n        var minW = Math.min(BW, this.BW);\n        var minH = Math.min(BH, this.BH);\n        var pixels = new Float32Array(minW * minH * 4);\n        gl.readPixels(0, 0, minW, minH, gl.RGBA, gl.FLOAT, pixels);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        var newIndex = index + 1; // !!!\n\n        var newTexture = gl.createTexture();\n        gl.activeTexture(gl.TEXTURE0 + newIndex);\n        gl.bindTexture(gl.TEXTURE_2D, newTexture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, BW, BH, 0, gl.RGBA, gl.FLOAT, null);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, minW, minH, gl.RGBA, gl.FLOAT, pixels);\n        var newBuffer = gl.createFramebuffer();\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.deleteTexture(texture);\n        gl.activeTexture(gl.TEXTURE0 + index);\n        gl.bindTexture(gl.TEXTURE_2D, newTexture);\n        this.index = index;\n        this.texture = newTexture;\n        this.buffer = newBuffer;\n        this.BW = BW;\n        this.BH = BH;\n      }\n    }]);\n\n    return Buffer;\n  }();\n\n  exports.Buffer = Buffer;\n\n  var IOBuffer =\n  /*#__PURE__*/\n  function () {\n    function IOBuffer(index, key, vertexString, fragmentString) {\n      _classCallCheck(this, IOBuffer);\n\n      this.isValid = false;\n      this.index = index;\n      this.key = key;\n      this.vertexString = vertexString;\n      this.fragmentString = fragmentString;\n    }\n\n    _createClass(IOBuffer, [{\n      key: \"create\",\n      value: function create(gl, BW, BH) {\n        var vertexShader = context_1.default.createShader(gl, this.vertexString, gl.VERTEX_SHADER);\n        var fragmentShader = context_1.default.createShader(gl, this.fragmentString, gl.FRAGMENT_SHADER, 1);\n\n        if (!fragmentShader) {\n          fragmentShader = context_1.default.createShader(gl, 'void main(){\\n\\tgl_FragColor = vec4(1.0);\\n}', gl.FRAGMENT_SHADER);\n          this.isValid = false;\n        } else {\n          this.isValid = true;\n        }\n\n        var program = context_1.default.createProgram(gl, [vertexShader, fragmentShader]); // gl.useProgram(program);\n\n        var input = new Buffer(gl, BW, BH, this.index + 0);\n        var output = new Buffer(gl, BW, BH, this.index + 2);\n        this.program = program;\n        this.input = input;\n        this.output = output;\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n      }\n    }, {\n      key: \"render\",\n      value: function render(gl, BW, BH) {\n        gl.useProgram(this.program);\n        gl.viewport(0, 0, BW, BH);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.output.buffer);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.output.texture, 0); // !!!\n\n        var e = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n\n        if (e != gl.FRAMEBUFFER_COMPLETE) {\n          console.log(e);\n        }\n\n        gl.drawArrays(gl.TRIANGLES, 0, 6); // swap\n\n        var temp = this.input;\n        var input = this.output;\n        var output = temp;\n        this.input = input;\n        this.output = output;\n      }\n    }, {\n      key: \"resize\",\n      value: function resize(gl, BW, BH) {\n        gl.useProgram(this.program);\n        gl.viewport(0, 0, BW, BH);\n        this.input.resize(gl, BW, BH);\n        this.output.resize(gl, BW, BH);\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy(gl) {\n        gl.deleteProgram(this.program);\n        this.program = null;\n        this.input = null;\n        this.output = null;\n      }\n    }]);\n\n    return IOBuffer;\n  }();\n\n  exports.IOBuffer = IOBuffer;\n\n  var Buffers =\n  /*#__PURE__*/\n  function (_Map) {\n    _inherits(Buffers, _Map);\n\n    function Buffers() {\n      _classCallCheck(this, Buffers);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(Buffers).apply(this, arguments));\n    }\n\n    _createClass(Buffers, [{\n      key: \"count\",\n      get: function get() {\n        return this.size * 4;\n      }\n    }], [{\n      key: \"getBuffers\",\n      value: function getBuffers(gl, fragmentString, vertexString) {\n        var buffers = new Buffers();\n        var count = 0;\n\n        if (fragmentString) {\n          var regexp = /(?:^\\s*)((?:#if|#elif)(?:\\s*)(defined\\s*\\(\\s*BUFFER_)(\\d+)(?:\\s*\\))|(?:#ifdef)(?:\\s*BUFFER_)(\\d+)(?:\\s*))/gm;\n          var matches;\n\n          while ((matches = regexp.exec(fragmentString)) !== null) {\n            var i = matches[3] || matches[4];\n            var key = 'u_buffer' + i;\n            var buffer = new IOBuffer(count, key, vertexString, '#define BUFFER_' + i + '\\n' + fragmentString);\n            buffer.create(gl, gl.drawingBufferWidth, gl.drawingBufferHeight);\n            buffers.set(key, buffer);\n            count += 4;\n          }\n        }\n\n        return buffers;\n      }\n    }]);\n\n    return Buffers;\n  }(_wrapNativeSuper(Map));\n\n  exports.default = Buffers;\n});\n\n},{\"./context\":3}],3:[function(require,module,exports){\n\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  var ContextError;\n\n  (function (ContextError) {\n    ContextError[ContextError[\"BrowserSupport\"] = 1] = \"BrowserSupport\";\n    ContextError[ContextError[\"Other\"] = 2] = \"Other\";\n  })(ContextError = exports.ContextError || (exports.ContextError = {}));\n\n  var ContextVertexBuffers = function ContextVertexBuffers() {\n    _classCallCheck(this, ContextVertexBuffers);\n  };\n\n  exports.ContextVertexBuffers = ContextVertexBuffers;\n\n  var Context =\n  /*#__PURE__*/\n  function () {\n    function Context() {\n      _classCallCheck(this, Context);\n    }\n\n    _createClass(Context, null, [{\n      key: \"tryGetContext\",\n      value: function tryGetContext(canvas, attributes, errorCallback) {\n        function handleError(errorCode, html) {\n          if (typeof errorCallback === 'function') {\n            errorCallback(errorCode);\n          } else {\n            var container = canvas.parentNode;\n\n            if (container) {\n              container.innerHTML = \"<div class=\\\"glsl-canvas--error\\\">\".concat(html, \"</div>\");\n            }\n          }\n        }\n\n        if (!WebGLRenderingContext) {\n          handleError(ContextError.BrowserSupport, \"This page requires a browser that supports WebGL.<br/>\\n\\t\\t\\t<a href=\\\"http://get.webgl.org\\\">Click here to upgrade your browser.</a>\");\n          return null;\n        }\n\n        var context = Context.getContext(canvas, attributes);\n\n        if (!context) {\n          handleError(ContextError.Other, \"It does not appear your computer can support WebGL.<br/>\\n\\t\\t\\t<a href=\\\"http://get.webgl.org/troubleshooting/\\\">Click here for more information.</a>\");\n        } else {\n          context.getExtension('OES_standard_derivatives');\n        }\n\n        return context;\n      }\n    }, {\n      key: \"getContext\",\n      value: function getContext(canvas, options) {\n        var names = ['webgl', 'experimental-webgl'];\n        var context = null;\n\n        for (var i = 0; i < names.length; ++i) {\n          try {\n            context = canvas.getContext(names[i], options);\n          } catch (e) {\n            if (context) {\n              break;\n            }\n          }\n        }\n\n        return context;\n      }\n    }, {\n      key: \"createShader\",\n      value: function createShader(gl, source, type) {\n        var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var shader = gl.createShader(type);\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n        var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n        if (!compiled) {\n          // Something went wrong during compilation; get the error\n          Context.lastError = gl.getShaderInfoLog(shader);\n          console.error('*** Error compiling shader ' + shader + ':' + Context.lastError); // main.trigger('error', {\n\n          gl.deleteShader(shader);\n          throw {\n            shader: shader,\n            source: source,\n            type: type,\n            error: Context.lastError,\n            offset: offset\n          };\n        }\n\n        return shader;\n      }\n    }, {\n      key: \"createProgram\",\n      value: function createProgram(gl, shaders, attributes, locations) {\n        var program = gl.createProgram();\n\n        for (var i = 0; i < shaders.length; ++i) {\n          gl.attachShader(program, shaders[i]);\n        }\n\n        if (attributes && locations) {\n          for (var _i = 0; _i < attributes.length; ++_i) {\n            gl.bindAttribLocation(program, locations ? locations[_i] : _i, attributes[_i]);\n          }\n        }\n\n        gl.linkProgram(program); // Check the link status\n\n        var linked = gl.getProgramParameter(program, gl.LINK_STATUS);\n\n        if (!linked) {\n          // something went wrong with the link\n          Context.lastError = gl.getProgramInfoLog(program);\n          console.log('Error in program linking:' + Context.lastError);\n          gl.deleteProgram(program);\n          return null;\n        }\n\n        return program;\n      }\n    }, {\n      key: \"createVertexBuffers\",\n      value: function createVertexBuffers(gl, program) {\n        var vertexBuffers = new ContextVertexBuffers();\n        var texcoordIndex = gl.getAttribLocation(program, 'a_texcoord');\n        vertexBuffers.texcoord = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffers.texcoord);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n        gl.enableVertexAttribArray(texcoordIndex);\n        gl.vertexAttribPointer(texcoordIndex, 2, gl.FLOAT, false, 0, 0);\n        var positionIndex = gl.getAttribLocation(program, 'a_position');\n        vertexBuffers.position = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffers.position);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0]), gl.STATIC_DRAW);\n        gl.enableVertexAttribArray(positionIndex);\n        gl.vertexAttribPointer(positionIndex, 2, gl.FLOAT, false, 0, 0);\n        return vertexBuffers;\n      }\n    }]);\n\n    return Context;\n  }();\n\n  Context.lastError = '';\n  exports.default = Context;\n});\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  }\n  result[\"default\"] = mod;\n  return result;\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"whatwg-fetch\", \"./buffers\", \"./context\", \"./listener.subscriber\", \"./textures\", \"./uniforms\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  }); // import '@babel/polyfill';\n\n  require(\"whatwg-fetch\");\n\n  var buffers_1 = __importDefault(require(\"./buffers\"));\n\n  var context_1 = __importDefault(require(\"./context\"));\n\n  var listener_subscriber_1 = __importDefault(require(\"./listener.subscriber\"));\n\n  var textures_1 = __importStar(require(\"./textures\"));\n\n  var uniforms_1 = __importDefault(require(\"./uniforms\"));\n\n  var GlslCanvasDefaultVertex = \"\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texcoord;\\n\\nvarying vec2 v_texcoord;\\n\\nvoid main(){\\n\\tgl_Position = vec4(a_position, 0.0, 1.0);\\n\\tv_texcoord = a_texcoord;\\n}\\n\";\n  var GlslCanvasDefaultFragment = \"\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nvarying vec2 v_texcoord;\\n\\nvoid main(){\\n\\tgl_FragColor = vec4(0.0);\\n}\\n\";\n\n  var GlslCanvasOptions = function GlslCanvasOptions() {\n    _classCallCheck(this, GlslCanvasOptions);\n  };\n\n  exports.GlslCanvasOptions = GlslCanvasOptions;\n\n  var GlslCanvasTimer =\n  /*#__PURE__*/\n  function () {\n    function GlslCanvasTimer() {\n      _classCallCheck(this, GlslCanvasTimer);\n\n      this.delay = 0.0;\n      this.current = 0.0;\n      this.delta = 0.0;\n      this.paused = false;\n      this.start = this.previous = performance.now() / 1000.0;\n    }\n\n    _createClass(GlslCanvasTimer, [{\n      key: \"play\",\n      value: function play() {\n        if (this.previous) {\n          var now = performance.now() / 1000.0;\n          this.delay += now - this.previous;\n          this.previous = now;\n        } // console.log(this.delay);\n\n\n        this.paused = false;\n      }\n    }, {\n      key: \"pause\",\n      value: function pause() {\n        this.paused = true;\n      }\n    }, {\n      key: \"next\",\n      value: function next() {\n        var now = performance.now() / 1000.0;\n        this.delta = now - this.previous;\n        this.current = now - this.start - this.delay;\n        this.previous = now;\n        return this;\n      }\n    }]);\n\n    return GlslCanvasTimer;\n  }();\n\n  exports.GlslCanvasTimer = GlslCanvasTimer;\n\n  var GlslCanvas =\n  /*#__PURE__*/\n  function (_listener_subscriber_) {\n    _inherits(GlslCanvas, _listener_subscriber_);\n\n    function GlslCanvas(canvas) {\n      var _this;\n\n      var contextOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      _classCallCheck(this, GlslCanvas);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(GlslCanvas).call(this));\n      _this.dirty = true;\n      _this.animated = false;\n      _this.nDelta = 0;\n      _this.nTime = 0;\n      _this.nDate = 0;\n      _this.nMouse = 0;\n      _this.textureList = [];\n      _this.textures = new textures_1.default();\n      _this.buffers = new buffers_1.default();\n      _this.uniforms = new uniforms_1.default();\n      _this.mouse = {\n        x: 0,\n        y: 0\n      };\n      _this.valid = false;\n      _this.visible = false;\n\n      if (!canvas) {\n        return _possibleConstructorReturn(_this);\n      }\n\n      _this.canvas = canvas;\n      _this.width = canvas.clientWidth;\n      _this.height = canvas.clientHeight;\n      _this.rect = canvas.getBoundingClientRect();\n      _this.vertexString = contextOptions.vertexString || GlslCanvasDefaultVertex;\n      _this.fragmentString = contextOptions.fragmentString || GlslCanvasDefaultFragment;\n      var gl = context_1.default.tryGetContext(canvas, contextOptions, options.onError);\n\n      if (!gl) {\n        return _possibleConstructorReturn(_this);\n      }\n\n      _this.gl = gl;\n      _this.pixelRatio = window.devicePixelRatio || 1;\n      canvas.style.backgroundColor = contextOptions.backgroundColor || 'rgba(0,0,0,0)';\n\n      _this.getShaders().then(function (success) {\n        _this.load();\n\n        if (!_this.program) {\n          return;\n        }\n\n        _this.addListeners();\n\n        _this.loop(); // this.animated = false;\n\n      }, function (error) {\n        console.log('error', error);\n      });\n\n      return _this;\n    }\n\n    _createClass(GlslCanvas, [{\n      key: \"getShaders\",\n      value: function getShaders() {\n        var _this2 = this;\n\n        return new Promise(function (resolve, reject) {\n          var canvas = _this2.canvas;\n          var urls = [];\n\n          if (canvas.hasAttribute('data-vertex-url')) {\n            urls.push(canvas.getAttribute('data-vertex-url'));\n          }\n\n          if (canvas.hasAttribute('data-fragment-url')) {\n            urls.push(canvas.getAttribute('data-fragment-url'));\n          }\n\n          if (urls.length) {\n            Promise.all(urls.map(function (url, i) {\n              return fetch(url).then(function (response) {\n                return response.text();\n              }).then(function (body) {\n                if (i === 0) {\n                  return _this2.vertexString = body;\n                } else {\n                  return _this2.fragmentString = body;\n                }\n              });\n            })).then(function (shaders) {\n              resolve(shaders);\n            });\n          } else {\n            if (canvas.hasAttribute('data-vertex')) {\n              _this2.vertexString = canvas.getAttribute('data-vertex');\n            }\n\n            if (canvas.hasAttribute('data-fragment')) {\n              _this2.fragmentString = canvas.getAttribute('data-fragment');\n            }\n\n            resolve([_this2.vertexString, _this2.fragmentString]);\n          }\n        });\n      }\n    }, {\n      key: \"addListeners\",\n      value: function addListeners() {\n        var _this3 = this;\n\n        // resize buffers on canvas resize\n        // consider applying a throttle of 50 ms on canvas resize\n        // to avoid requestAnimationFrame and Gl violations\n        var resize = function resize(e) {\n          _this3.rect = _this3.canvas.getBoundingClientRect();\n        };\n\n        var scroll = function scroll(e) {\n          _this3.rect = _this3.canvas.getBoundingClientRect();\n        };\n\n        var mousemove = function mousemove(e) {\n          _this3.mouse.x = e.clientX || e.pageX;\n          _this3.mouse.y = e.clientY || e.pageY;\n        };\n\n        var click = function click(e) {\n          _this3.toggle();\n        };\n\n        var loop = function loop(time) {\n          _this3.checkRender();\n\n          window.requestAnimationFrame(loop);\n        };\n\n        this.resize = resize;\n        this.scroll = scroll;\n        this.mousemove = mousemove;\n        this.click = click;\n        this.loop = loop;\n        window.addEventListener('resize', resize);\n        window.addEventListener('scroll', scroll);\n        document.addEventListener('mousemove', mousemove, false);\n\n        if (this.canvas.hasAttribute('controls')) {\n          this.canvas.addEventListener('click', click);\n\n          if (!this.canvas.hasAttribute('autoplay')) {\n            this.pause();\n          }\n        }\n      }\n    }, {\n      key: \"load\",\n      value: function load(fragmentString, vertexString) {\n        if (vertexString) {\n          this.vertexString = vertexString;\n        }\n\n        if (fragmentString) {\n          this.fragmentString = fragmentString;\n        }\n\n        var gl = this.gl;\n        var vertexShader = context_1.default.createShader(gl, this.vertexString, gl.VERTEX_SHADER);\n        var fragmentShader = context_1.default.createShader(gl, this.fragmentString, gl.FRAGMENT_SHADER); // If Fragment shader fails load a empty one to sign the error\n\n        if (!fragmentShader) {\n          fragmentShader = context_1.default.createShader(gl, \"void main(){\\n\\t\\t\\t\\tgl_FragColor = vec4(1.0);\\n\\t\\t\\t}\", gl.FRAGMENT_SHADER);\n          this.valid = false;\n        } else {\n          this.valid = true;\n        } // Create and use program\n\n\n        var program = context_1.default.createProgram(gl, [vertexShader, fragmentShader]); //, [0,1],['a_texcoord','a_position']);\n\n        gl.useProgram(program); // Delete shaders\n        // gl.detachShader(program, vertexShader);\n        // gl.detachShader(program, fragmentShader);\n\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n        this.program = program;\n\n        if (this.valid) {\n          this.buffers = buffers_1.default.getBuffers(gl, this.fragmentString, this.vertexString);\n          this.vertexBuffers = context_1.default.createVertexBuffers(gl, program);\n          this.createUniforms(); // this.getBuffers(this.fragmentString);\n        } // Trigger event\n\n\n        this.trigger('load', {}); // this.render();\n      }\n    }, {\n      key: \"test\",\n      value: function test(fragmentString, vertexString) {\n        var _this4 = this;\n\n        return new Promise(function (resolve, reject) {\n          // Thanks to @thespite for the help here\n          // https://www.khronos.org/registry/webgl/extensions/EXT_disjoint_timer_query/\n          var vertex = _this4.vertexString;\n          var fragment = _this4.fragmentString;\n          var paused = _this4.timer.paused;\n\n          var extension = _this4.gl.getExtension('EXT_disjoint_timer_query');\n\n          var query = extension.createQueryEXT();\n          var wasValid = _this4.valid;\n\n          if (fragmentString || vertexString) {\n            _this4.load(fragmentString, vertexString);\n\n            wasValid = _this4.valid;\n\n            _this4.render();\n          }\n\n          _this4.timer.paused = true;\n          extension.beginQueryEXT(extension.TIME_ELAPSED_EXT, query);\n\n          _this4.render();\n\n          extension.endQueryEXT(extension.TIME_ELAPSED_EXT);\n\n          var waitForTest = function waitForTest() {\n            _this4.render();\n\n            var available = extension.getQueryObjectEXT(query, extension.QUERY_RESULT_AVAILABLE_EXT);\n\n            var disjoint = _this4.gl.getParameter(extension.GPU_DISJOINT_EXT);\n\n            if (available && !disjoint) {\n              var result = {\n                wasValid: wasValid,\n                fragment: fragmentString || _this4.fragmentString,\n                vertex: vertexString || _this4.vertexString,\n                timeElapsedMs: extension.getQueryObjectEXT(query, extension.QUERY_RESULT_EXT) / 1000000.0\n              };\n              _this4.timer.paused = paused;\n\n              if (fragmentString || vertexString) {\n                _this4.load(fragment, vertex);\n              }\n\n              resolve(result);\n            } else {\n              window.requestAnimationFrame(waitForTest);\n            }\n          };\n\n          waitForTest();\n        });\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this.animated = false;\n        this.valid = false;\n        var gl = this.gl;\n        /*\n        // !!!\n        for (let texture in this.textures) {\n            if (texture.destroy) {\n                texture.destroy(gl);\n            }\n        }\n        */\n\n        gl.useProgram(null);\n        gl.deleteProgram(this.program);\n        this.buffers.forEach(function (buffer) {\n          return buffer.destroy(gl);\n        });\n        this.buffers = null;\n        this.textures = null;\n        this.uniforms = null;\n        this.program = null;\n        this.gl = null;\n      }\n    }, {\n      key: \"setUniform\",\n      value: function setUniform(key) {\n        var _uniforms_1$default;\n\n        for (var _len = arguments.length, values = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          values[_key - 1] = arguments[_key];\n        }\n\n        var uniform = (_uniforms_1$default = uniforms_1.default).parseUniform.apply(_uniforms_1$default, [key].concat(values));\n\n        if (uniform) {\n          if (uniform.type === 'sampler2D') {\n            this.loadTexture(key, values[0]);\n          } else {\n            this.uniforms.set(key, uniform);\n          }\n        }\n      }\n    }, {\n      key: \"setUniforms\",\n      value: function setUniforms(values) {\n        var _this5 = this;\n\n        values.forEach(function (value, key) {\n          _this5.setUniform.apply(_this5, [key].concat(_toConsumableArray(value)));\n        });\n      }\n    }, {\n      key: \"pause\",\n      value: function pause() {\n        this.timer.pause();\n        this.canvas.classList.add('paused');\n      }\n    }, {\n      key: \"play\",\n      value: function play() {\n        this.timer.play();\n        this.canvas.classList.remove('paused');\n      }\n    }, {\n      key: \"toggle\",\n      value: function toggle() {\n        if (this.timer.paused) {\n          this.play();\n        } else {\n          this.pause();\n        }\n      }\n    }, {\n      key: \"isVisible\",\n      value: function isVisible() {\n        var rect = this.rect;\n        return rect.top + rect.height > 0 && rect.top < (window.innerHeight || document.documentElement.clientHeight);\n      }\n    }, {\n      key: \"isAnimated\",\n      value: function isAnimated() {\n        return (this.animated || this.textures.animated) && !this.timer.paused;\n      }\n    }, {\n      key: \"isDirty\",\n      value: function isDirty() {\n        return this.dirty || this.uniforms.dirty || this.textures.dirty; // Array.from(this.textures.values()).reduce((p, texture) => p || texture.dirty, false);\n        // this.textures.dirty;\n      } // !!!\n\n    }, {\n      key: \"sizeDidChanged\",\n      value: function sizeDidChanged() {\n        var gl = this.gl;\n        var rect = this.rect;\n        var W = rect.width,\n            H = rect.height;\n\n        if (this.width !== W || this.height !== H) {\n          this.width = W;\n          this.height = H; // Lookup the size the browser is displaying the canvas in CSS pixels\n          // and compute a size needed to make our drawingbuffer match it in\n          // device pixels.\n\n          var BW = Math.floor(W * this.pixelRatio);\n          var BH = Math.floor(H * this.pixelRatio); // Check if the canvas is not the same size.\n\n          if (gl.canvas.width !== BW || gl.canvas.height !== BH) {\n            // Make the canvas the same size\n            gl.canvas.width = BW;\n            gl.canvas.height = BH; // Set the viewport to match\n            // gl.viewport(0, 0, BW, BH);\n          }\n\n          this.buffers.forEach(function (buffer) {\n            buffer.resize(gl, BW, BH);\n          }); // gl.useProgram(this.program);\n\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }, {\n      key: \"checkRender\",\n      value: function checkRender() {\n        if (this.isVisible() && (this.sizeDidChanged() || this.isAnimated() || this.isDirty())) {\n          this.render();\n          this.canvas.classList.add('playing');\n        } else {\n          this.canvas.classList.remove('playing');\n        }\n      }\n    }, {\n      key: \"createUniforms\",\n      value: function createUniforms() {\n        var _this6 = this;\n\n        var gl = this.gl;\n        var fragmentString = this.fragmentString;\n        var BW = gl.drawingBufferWidth;\n        var BH = gl.drawingBufferHeight;\n        var timer = this.timer = new GlslCanvasTimer();\n        var hasDelta = (fragmentString.match(/u_delta/g) || []).length > 1;\n        var hasTime = (fragmentString.match(/u_time/g) || []).length > 1;\n        var hasDate = (fragmentString.match(/u_date/g) || []).length > 1;\n        var hasMouse = (fragmentString.match(/u_mouse/g) || []).length > 1;\n        var hasTextures = this.parseTextures(fragmentString);\n        this.animated = hasTime || hasDate || hasMouse;\n\n        if (this.animated) {\n          this.canvas.classList.add('animated');\n        } else {\n          this.canvas.classList.remove('animated');\n        }\n\n        this.uniforms.create('2f', 'vec2', 'u_resolution', BW, BH);\n\n        if (hasDelta) {\n          this.uniforms.create('1f', 'float', 'u_delta', timer.delta);\n        }\n\n        if (hasTime) {\n          this.uniforms.create('1f', 'float', 'u_time', timer.current);\n        }\n\n        if (hasDate) {\n          var date = new Date();\n          this.uniforms.create('4f', 'float', 'u_date', date.getFullYear(), date.getMonth(), date.getDate(), date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds() + date.getMilliseconds() * 0.001);\n        }\n\n        if (hasMouse) {\n          this.uniforms.create('2f', 'vec2', 'u_mouse', 0, 0);\n        }\n\n        this.buffers.forEach(function (buffer) {\n          _this6.uniforms.create('1i', 'sampler2D', buffer.key, buffer.input.index);\n        });\n\n        if (hasTextures) {\n          this.textureList.forEach(function (x) {\n            _this6.loadTexture(x.key, x.url);\n          });\n        }\n        /*\n        while (this.textureList.length > 0) {\n            const x = this.textureList.shift();\n            this.loadTexture(x.key, x.url);\n        }\n        */\n\n      }\n    }, {\n      key: \"parseTextures\",\n      value: function parseTextures(fragmentString) {\n        var _this7 = this;\n\n        var hasTextures = fragmentString.search(/sampler2D/g);\n\n        if (hasTextures) {\n          var lines = fragmentString.split('\\n');\n\n          for (var i = 0; i < lines.length; i++) {\n            var match = lines[i].match(/uniform\\s*sampler2D\\s*([\\w]*);\\s*\\/\\/\\s*([\\w|\\:\\/\\/|\\.|\\-|\\_]*)/i);\n\n            if (match) {\n              var ext = match[2].split('.').pop().toLowerCase();\n              var key = match[1];\n              var url = match[2];\n\n              if (key && url && textures_1.TextureExtensions.indexOf(ext) !== -1) {\n                this.textureList.push({\n                  key: key,\n                  url: url\n                }); // this.loadTexture(key, url);\n              }\n            }\n\n            var main = lines[i].match(/\\s*void\\s*main\\s*/g);\n\n            if (main) {\n              break;\n            }\n          }\n        }\n\n        if (this.canvas.hasAttribute('data-textures')) {\n          var urls = this.canvas.getAttribute('data-textures').split(',');\n          urls.forEach(function (url, i) {\n            var key = 'u_tex' + i;\n\n            _this7.textureList.push({\n              key: key,\n              url: url\n            }); // this.loadTexture(key, url);\n\n          });\n        }\n\n        return this.textureList.length > 0;\n      }\n    }, {\n      key: \"loadTexture\",\n      value: function loadTexture(key, url) {\n        var _this8 = this;\n\n        if (this.valid) {\n          return this.textures.createOrUpdate(this.gl, key, url, this.buffers.count).then(function (texture) {\n            var index = texture.index;\n\n            var uniform = _this8.uniforms.createTexture(key, index);\n\n            uniform.texture = texture;\n\n            var uniformResolution = _this8.uniforms.create('2f', 'vec2', key + 'Resolution', texture.width, texture.height);\n\n            console.log('loadTexture', key, url, index, texture.width, texture.height);\n            return texture;\n          });\n        } else {\n          this.textureList.push({\n            key: key,\n            url: url\n          });\n        }\n      }\n    }, {\n      key: \"updateUniforms\",\n      value: function updateUniforms() {\n        var _this9 = this;\n\n        var gl = this.gl;\n        var BW = gl.drawingBufferWidth;\n        var BH = gl.drawingBufferHeight;\n        var timer = this.timer.next();\n        this.uniforms.update('2f', 'vec2', 'u_resolution', BW, BH);\n\n        if (this.uniforms.has('u_delta')) {\n          this.uniforms.update('1f', 'float', 'u_delta', timer.delta);\n        }\n\n        if (this.uniforms.has('u_time')) {\n          this.uniforms.update('1f', 'float', 'u_time', timer.current);\n        }\n\n        if (this.uniforms.has('u_date')) {\n          var date = new Date();\n          this.uniforms.update('4f', 'float', 'u_date', date.getFullYear(), date.getMonth(), date.getDate(), date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds() + date.getMilliseconds() * 0.001);\n        }\n\n        if (this.uniforms.has('u_mouse')) {\n          var rect = this.rect;\n          var mouse = this.mouse;\n\n          if (mouse.x >= rect.left && mouse.x <= rect.right && mouse.y >= rect.top && mouse.y <= rect.bottom) {\n            var MX = (mouse.x - rect.left) * this.pixelRatio;\n            var MY = this.canvas.height - (mouse.y - rect.top) * this.pixelRatio;\n            this.uniforms.update('2f', 'vec2', 'u_mouse', MX, MY);\n          }\n        }\n\n        this.buffers.forEach(function (buffer) {\n          _this9.uniforms.update('1i', 'sampler2D', buffer.key, buffer.input.index);\n        });\n        this.textures.forEach(function (texture) {\n          texture.tryUpdate(gl); // console.log(texture.key, texture.index);\n\n          _this9.uniforms.update('1i', 'sampler2D', texture.key, texture.index);\n        });\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var _this10 = this;\n\n        var gl = this.gl;\n        var BW = gl.drawingBufferWidth;\n        var BH = gl.drawingBufferHeight;\n        this.updateUniforms();\n        this.buffers.forEach(function (buffer) {\n          _this10.uniforms.apply(gl, buffer.program);\n\n          buffer.render(gl, BW, BH);\n        });\n        gl.useProgram(this.program);\n        this.uniforms.apply(gl, this.program);\n        gl.viewport(0, 0, BW, BH);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\n        this.uniforms.forEach(function (uniform) {\n          return uniform.dirty = false;\n        });\n        this.uniforms.dirty = false;\n        this.textures.forEach(function (texture) {\n          return texture.dirty = false;\n        });\n        this.textures.dirty = false;\n        this.dirty = false;\n        this.trigger('render', {});\n      }\n    }], [{\n      key: \"version\",\n      value: function version() {\n        return '0.1.8';\n      }\n    }, {\n      key: \"isDifferent\",\n      value: function isDifferent(a, b) {\n        if (a && b) {\n          return a.toString() !== b.toString();\n        }\n\n        return false;\n      }\n    }]);\n\n    return GlslCanvas;\n  }(listener_subscriber_1.default);\n\n  exports.default = GlslCanvas;\n  window.GlslCanvas = GlslCanvas;\n\n  var loadAllGlslCanvas = function loadAllGlslCanvas() {\n    var canvases = Array.from(document.getElementsByClassName('glslCanvas')).filter(function (x) {\n      return x instanceof HTMLCanvasElement;\n    });\n    window.glslCanvases = canvases.map(function (x) {\n      return new GlslCanvas(x);\n    }).filter(function (x) {\n      return x.valid;\n    });\n  };\n\n  window.addEventListener('load', function () {\n    loadAllGlslCanvas();\n  });\n});\n\n},{\"./buffers\":2,\"./context\":3,\"./listener.subscriber\":5,\"./textures\":6,\"./uniforms\":7,\"whatwg-fetch\":1}],5:[function(require,module,exports){\n\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var Listener = function Listener(event, callback) {\n    _classCallCheck(this, Listener);\n\n    this.event = event;\n    this.callback = callback;\n  };\n\n  exports.Listener = Listener;\n\n  var ListenerSubscriber =\n  /*#__PURE__*/\n  function () {\n    function ListenerSubscriber() {\n      _classCallCheck(this, ListenerSubscriber);\n\n      this.listeners = new Set();\n    }\n\n    _createClass(ListenerSubscriber, [{\n      key: \"listSubscriptions\",\n      value: function listSubscriptions() {\n        this.listeners.forEach(function (x) {\n          return console.log(x);\n        });\n      }\n    }, {\n      key: \"subscribe\",\n      value: function subscribe(listener) {\n        this.listeners.add(listener);\n      }\n    }, {\n      key: \"unsubscribe\",\n      value: function unsubscribe(listener) {\n        this.listeners.delete(listener);\n      }\n    }, {\n      key: \"unsubscribeAll\",\n      value: function unsubscribeAll() {\n        this.listeners.clear();\n      }\n    }, {\n      key: \"on\",\n      value: function on(event, callback) {\n        this.listeners.add(new Listener(event, callback));\n        return this;\n      }\n    }, {\n      key: \"off\",\n      value: function off(event, callback) {\n        var _this = this;\n\n        if (callback) {\n          this.listeners.delete(new Listener(event, callback));\n        } else {\n          this.listeners.forEach(function (x) {\n            if (x.event === event) {\n              _this.listeners.delete(x);\n            }\n          });\n        }\n\n        return this;\n      }\n    }, {\n      key: \"trigger\",\n      value: function trigger(event) {\n        for (var _len = arguments.length, data = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          data[_key - 1] = arguments[_key];\n        }\n\n        this.listeners.forEach(function (x) {\n          if (x.event === event && typeof x.callback === 'function') {\n            x.callback.apply(x, data);\n          }\n        });\n        return this;\n      }\n    }]);\n\n    return ListenerSubscriber;\n  }();\n\n  exports.default = ListenerSubscriber;\n});\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"./listener.subscriber\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  }); // Texture management\n\n  var listener_subscriber_1 = __importDefault(require(\"./listener.subscriber\"));\n\n  exports.TextureImageExtensions = ['jpg', 'jpeg', 'png'];\n  exports.TextureVideoExtensions = ['ogv', 'webm', 'mp4'];\n  exports.TextureExtensions = exports.TextureImageExtensions.concat(exports.TextureVideoExtensions);\n  var TextureSourceType;\n\n  (function (TextureSourceType) {\n    TextureSourceType[TextureSourceType[\"Data\"] = 0] = \"Data\";\n    TextureSourceType[TextureSourceType[\"Element\"] = 1] = \"Element\";\n    TextureSourceType[TextureSourceType[\"Url\"] = 2] = \"Url\";\n  })(TextureSourceType || (TextureSourceType = {}));\n\n  var TextureFilteringType;\n\n  (function (TextureFilteringType) {\n    TextureFilteringType[\"MipMap\"] = \"mipmap\";\n    TextureFilteringType[\"Linear\"] = \"linear\";\n    TextureFilteringType[\"Nearest\"] = \"nearest\";\n  })(TextureFilteringType || (TextureFilteringType = {}));\n\n  var TextureData = function TextureData() {\n    _classCallCheck(this, TextureData);\n  };\n\n  exports.TextureData = TextureData;\n\n  var TextureOptions = function TextureOptions() {\n    _classCallCheck(this, TextureOptions);\n  };\n\n  exports.TextureOptions = TextureOptions; // GL texture wrapper object for keeping track of a global set of textures, keyed by a unique user-defined name\n\n  var Texture =\n  /*#__PURE__*/\n  function (_listener_subscriber_) {\n    _inherits(Texture, _listener_subscriber_);\n\n    function Texture(gl, key, index) {\n      var _this;\n\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new TextureOptions();\n\n      _classCallCheck(this, Texture);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(Texture).call(this));\n      _this.valid = false;\n      _this.dirty = false;\n      _this.animated = false;\n      _this.powerOf2 = false;\n      _this.key = key;\n      _this.index = index;\n      _this.options = options;\n\n      _this.create(gl);\n\n      return _this;\n    }\n\n    _createClass(Texture, [{\n      key: \"create\",\n      value: function create(gl) {\n        this.texture = gl.createTexture();\n\n        if (this.texture) {\n          this.valid = true;\n        } // Default to a 1-pixel black texture so we can safely render while we wait for an image to load\n        // See: http://stackoverflow.com/questions/19722247/webgl-wait-for-texture-to-load\n        // [255, 255, 255, 255]\n\n\n        this.setData(gl, 1, 1, new Uint8Array([0, 0, 0, 0]), {\n          filtering: TextureFilteringType.Linear\n        }); // this.bindTexture();\n        // this.load(options);\n      }\n    }, {\n      key: \"load\",\n      value: function load(gl) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        this.options = options;\n\n        if (typeof options.url === 'string') {\n          if (this.url === undefined || options.url !== this.url) {\n            return this.setUrl(gl, options.url, options);\n          } else {\n            return Promise.resolve(this);\n          }\n        } else if (options.element) {\n          return this.setElement(gl, options.element, options);\n        } else if (options.data && options.width && options.height) {\n          return this.setData(gl, options.width, options.height, options.data, options);\n        }\n      }\n    }, {\n      key: \"setUrl\",\n      value: function setUrl(gl, url) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n        if (!this.valid) {\n          return;\n        }\n\n        this.url = url; // save URL reference (will be overwritten when element is loaded below)\n\n        this.source = url;\n        this.sourceType = TextureSourceType.Url;\n        this.options = Object.assign(this.options, options);\n        var ext = url.split('.').pop().toLowerCase();\n        var isVideo = exports.TextureVideoExtensions.indexOf(ext) !== -1;\n        var element;\n        var promise;\n\n        if (isVideo) {\n          element = document.createElement('video'); // options.filtering = TextureFilteringType.Nearest;\n\n          promise = this.setElement(gl, element, options);\n          element.setAttribute('playsinline', 'true');\n          element.autoplay = true;\n          element.muted = true;\n          element.src = url;\n        } else {\n          element = new Image();\n          promise = this.setElement(gl, element, options);\n\n          if (!(Texture.isSafari() && url.slice(0, 5) === 'data:')) {\n            element.crossOrigin = 'anonymous';\n          }\n\n          element.src = url;\n        }\n\n        return promise;\n      }\n    }, {\n      key: \"setElement\",\n      value: function setElement(gl, element) {\n        var _this2 = this;\n\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        this.options = Object.assign(this.options, options);\n        return new Promise(function (resolve, reject) {\n          var originalElement = element; // a string element is interpeted as a CSS selector\n\n          if (typeof element === 'string') {\n            element = document.querySelector(element);\n          }\n\n          if (element instanceof HTMLCanvasElement || element instanceof HTMLImageElement || element instanceof HTMLVideoElement) {\n            _this2.source = element;\n            _this2.sourceType = TextureSourceType.Element;\n\n            if (element instanceof HTMLVideoElement) {\n              var video = element;\n              video.addEventListener('loadeddata', function (event) {\n                _this2.update(gl, options);\n\n                _this2.setFiltering(gl, options);\n\n                resolve(_this2);\n              });\n              video.addEventListener('error', function (error) {\n                reject(error);\n              });\n            } else if (element instanceof HTMLImageElement) {\n              element.addEventListener('load', function () {\n                _this2.update(gl, options);\n\n                _this2.setFiltering(gl, options);\n\n                resolve(_this2);\n              });\n              element.addEventListener('error', function (error) {\n                reject(error);\n              });\n            } else {\n              _this2.update(gl, options);\n\n              _this2.setFiltering(gl, options);\n\n              resolve(_this2);\n            }\n          } else {\n            var message = \"the 'element' parameter (`element: \".concat(JSON.stringify(originalElement), \"`) must be a CSS selector string, or a <canvas>, <image> or <video> object\");\n            console.log(\"Texture '\".concat(_this2.key, \"': \").concat(message), options);\n            reject(message);\n          }\n        });\n      }\n    }, {\n      key: \"setData\",\n      value: function setData(gl, width, height, data) {\n        var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n        this.width = width;\n        this.height = height;\n        this.options = Object.assign(this.options, options);\n        this.source = data;\n        this.sourceType = TextureSourceType.Data;\n        this.update(gl, options);\n        this.setFiltering(gl, options);\n        return Promise.resolve(this);\n      } // Uploads current image or buffer to the GPU (can be used to update animated textures on the fly)\n\n    }, {\n      key: \"update\",\n      value: function update(gl, options) {\n        if (!this.valid) {\n          return;\n        }\n\n        gl.activeTexture(gl.TEXTURE0 + this.index);\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, options.UNPACK_FLIP_Y_WEBGL === false ? 0 : 1);\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, options.UNPACK_PREMULTIPLY_ALPHA_WEBGL || 0);\n\n        if (this.sourceType === TextureSourceType.Element) {\n          if (this.source instanceof HTMLImageElement && this.source.naturalWidth && this.source.naturalHeight) {\n            this.width = this.source.naturalWidth;\n            this.height = this.source.naturalHeight;\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.source);\n          } else if (this.source instanceof HTMLVideoElement && this.source.videoWidth && this.source.videoHeight) {\n            this.width = this.source.videoWidth;\n            this.height = this.source.videoHeight;\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.source);\n          } else if (this.source instanceof HTMLCanvasElement) {\n            this.width = this.source.width;\n            this.height = this.source.height;\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.source);\n          }\n        } else if (this.sourceType === TextureSourceType.Data) {\n          var imageBuffer = this.source;\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, imageBuffer);\n        }\n\n        this.trigger('loaded', this);\n      }\n    }, {\n      key: \"tryUpdate\",\n      value: function tryUpdate(gl) {\n        var dirty = false;\n\n        if (this.animated) {\n          dirty = true;\n          this.update(gl, this.options);\n        }\n\n        return dirty;\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy(gl) {\n        if (!this.valid) {\n          return;\n        }\n\n        gl.deleteTexture(this.texture);\n        this.texture = null;\n        delete this.source;\n        this.source = null;\n        this.valid = false;\n      }\n    }, {\n      key: \"setFiltering\",\n      value: function setFiltering(gl, options) {\n        if (!this.valid) {\n          return;\n        }\n\n        var powerOf2 = Texture.isPowerOf2(this.width) && Texture.isPowerOf2(this.height);\n        var filtering = options.filtering || TextureFilteringType.MipMap;\n        var wrapS = options.TEXTURE_WRAP_S || options.repeat && gl.REPEAT || gl.CLAMP_TO_EDGE;\n        var wrapT = options.TEXTURE_WRAP_T || options.repeat && gl.REPEAT || gl.CLAMP_TO_EDGE;\n\n        if (!powerOf2) {\n          filtering = filtering === TextureFilteringType.MipMap ? TextureFilteringType.Linear : filtering;\n          wrapS = wrapT = gl.CLAMP_TO_EDGE;\n        }\n\n        this.powerOf2 = powerOf2;\n        this.filtering = filtering; // this.bindTexture();\n        // WebGL has strict requirements on non-power-of-2 textures:\n        // No mipmaps and must clamp to edge\n        // For power-of-2 textures, the following presets are available:\n        // mipmap: linear blend from nearest mip\n        // linear: linear blend from original image (no mips)\n        // nearest: nearest pixel from original image (no mips, 'blocky' look)\n\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT);\n\n        if (this.filtering === TextureFilteringType.MipMap) {\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR); // TODO: use trilinear filtering by defualt instead?\n\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n          gl.generateMipmap(gl.TEXTURE_2D);\n        } else if (this.filtering === TextureFilteringType.Nearest) {\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        } else if (this.filtering === TextureFilteringType.Linear) {\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        }\n      }\n    }], [{\n      key: \"isPowerOf2\",\n      value: function isPowerOf2(value) {\n        return (value & value - 1) === 0;\n      }\n    }, {\n      key: \"isSafari\",\n      value: function isSafari() {\n        return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n      }\n    }, {\n      key: \"isTextureUrl\",\n      value: function isTextureUrl(text) {\n        return /\\.(jpg|jpeg|png|ogv|webm|mp4)$/i.test(text);\n      }\n    }, {\n      key: \"isTexture\",\n      value: function isTexture(urlElementOrData) {\n        var options = Texture.getTextureOptions(urlElementOrData);\n        return options !== undefined;\n      }\n    }, {\n      key: \"getMaxTextureSize\",\n      value: function getMaxTextureSize(gl) {\n        return gl.getParameter(gl.MAX_TEXTURE_SIZE);\n      }\n    }, {\n      key: \"getTextureOptions\",\n      value: function getTextureOptions(urlElementOrData) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        if (typeof urlElementOrData === 'string') {\n          if (Texture.isTextureUrl(urlElementOrData)) {\n            options.url = urlElementOrData;\n            return options;\n          }\n\n          if (document) {\n            urlElementOrData = document.querySelector(urlElementOrData); // console.log(urlElementOrData);\n          }\n        }\n\n        if (urlElementOrData instanceof HTMLCanvasElement || urlElementOrData instanceof HTMLImageElement || urlElementOrData instanceof HTMLVideoElement) {\n          options.element = urlElementOrData;\n          return options;\n        } else if (urlElementOrData instanceof TextureData) {\n          options.data = urlElementOrData.data;\n          options.width = urlElementOrData.width;\n          options.height = urlElementOrData.height;\n          return options;\n        }\n      }\n    }]);\n\n    return Texture;\n  }(listener_subscriber_1.default);\n\n  exports.Texture = Texture;\n\n  var Textures =\n  /*#__PURE__*/\n  function (_Map) {\n    _inherits(Textures, _Map);\n\n    function Textures() {\n      var _this3;\n\n      _classCallCheck(this, Textures);\n\n      _this3 = _possibleConstructorReturn(this, _getPrototypeOf(Textures).apply(this, arguments));\n      _this3.count = 0;\n      _this3.dirty = false;\n      _this3.animated = false;\n      return _this3;\n    }\n\n    _createClass(Textures, [{\n      key: \"createOrUpdate\",\n      value: function createOrUpdate(gl, key, urlElementOrData) {\n        var _this4 = this;\n\n        var index = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n        var texture;\n        var textureOptions = Texture.getTextureOptions(urlElementOrData, options);\n\n        if (textureOptions !== undefined) {\n          texture = this.get(key);\n\n          if (!texture) {\n            texture = new Texture(gl, key, index + this.count, textureOptions);\n            this.count++;\n            this.set(key, texture);\n          } // return Promise.resolve(texture);\n\n\n          return texture.load(gl, textureOptions).then(function (texture) {\n            if (texture.source instanceof HTMLVideoElement) {\n              var video = texture.source; // console.log('video', video);\n\n              video.addEventListener('play', function () {\n                // console.log('play', texture.key);\n                texture.animated = true;\n                _this4.animated = true;\n              });\n              video.addEventListener('pause', function () {\n                // console.log('pause', texture.key);\n                texture.animated = false;\n                _this4.animated = Array.from(_this4.values()).reduce(function (flag, texture) {\n                  return flag || texture.animated;\n                }, false);\n              });\n              video.addEventListener('seeked', function () {\n                // console.log('seeked');\n                texture.update(gl, texture.options);\n                _this4.dirty = true;\n              }); // console.log('video');\n\n              /*\n              video.addEventListener('canplaythrough', () => {\n                  // !!!\n                  this.intervalID = setInterval(() => {\n                      this.update(gl, options);\n                  }, 15);\n              }, true);\n              video.addEventListener('ended', () => {\n                  video.currentTime = 0;\n                  video.play();\n              }, true);\n              */\n            }\n\n            return texture;\n          });\n        } else {\n          return Promise.reject(null);\n        }\n      }\n    }]);\n\n    return Textures;\n  }(_wrapNativeSuper(Map));\n\n  exports.default = Textures;\n});\n\n},{\"./listener.subscriber\":5}],7:[function(require,module,exports){\n\"use strict\";\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"./textures\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var textures_1 = require(\"./textures\");\n\n  var Uniform =\n  /*#__PURE__*/\n  function () {\n    function Uniform(options) {\n      var _this = this;\n\n      _classCallCheck(this, Uniform);\n\n      this.dirty = true;\n\n      if (options) {\n        Object.assign(this, options);\n      }\n\n      this.apply = function (gl, program) {\n        if (_this.dirty) {\n          gl.useProgram(program);\n          var method = 'uniform' + _this.method;\n          var location = gl.getUniformLocation(program, _this.key);\n          gl[method].apply(gl, [location].concat(_this.values));\n        }\n      };\n    }\n\n    _createClass(Uniform, null, [{\n      key: \"isDifferent\",\n      value: function isDifferent(a, b) {\n        if (a && b) {\n          return a.toString() !== b.toString();\n        }\n\n        return false;\n      }\n    }]);\n\n    return Uniform;\n  }();\n\n  exports.Uniform = Uniform;\n\n  var UniformTexture =\n  /*#__PURE__*/\n  function (_Uniform) {\n    _inherits(UniformTexture, _Uniform);\n\n    function UniformTexture(options) {\n      _classCallCheck(this, UniformTexture);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(UniformTexture).call(this, options));\n    }\n\n    return UniformTexture;\n  }(Uniform);\n\n  exports.UniformTexture = UniformTexture;\n\n  var Uniforms =\n  /*#__PURE__*/\n  function (_Map) {\n    _inherits(Uniforms, _Map);\n\n    function Uniforms() {\n      var _this2;\n\n      _classCallCheck(this, Uniforms);\n\n      _this2 = _possibleConstructorReturn(this, _getPrototypeOf(Uniforms).apply(this, arguments));\n      _this2.dirty = false;\n      return _this2;\n    }\n\n    _createClass(Uniforms, [{\n      key: \"setParse\",\n      value: function setParse(key) {\n        for (var _len = arguments.length, values = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          values[_key - 1] = arguments[_key];\n        }\n\n        var uniform = Uniforms.parseUniform.apply(Uniforms, [key].concat(values));\n\n        if (uniform) {\n          this.set(key, uniform);\n        }\n\n        return uniform;\n      }\n    }, {\n      key: \"create\",\n      value: function create(method, type, key) {\n        for (var _len2 = arguments.length, values = new Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {\n          values[_key2 - 3] = arguments[_key2];\n        }\n\n        var uniform = new Uniform({\n          method: method,\n          type: type,\n          key: key,\n          values: values\n        });\n        this.set(key, uniform);\n        this.dirty = true;\n        return uniform;\n      }\n    }, {\n      key: \"createTexture\",\n      value: function createTexture(key, index) {\n        var uniform = new UniformTexture({\n          method: '1i',\n          type: 'sampler2D',\n          key: key,\n          values: [index]\n        });\n        this.set(key, uniform);\n        this.dirty = true;\n        return uniform; // const uniform = this.setParse(key, url) as UniformTexture; // !!!\n        // console.log(uniform.type, key, url);\n\n        /*\n        if (uniform.type === 'sampler2D') {\n            // console.log(u, uniform);\n            // For textures, we need to track texture units, so we have a special setter\n            // this.uniformTexture(uniform.key, uniform.value[0]);\n            if (uniform.method === '1iv') {\n                // todo\n                uniform.values.map((\n                    urlElementOrData: string | HTMLCanvasElement | HTMLImageElement | HTMLVideoElement | Element | TextureData,\n                    i: number\n                ) => this.uniformTexture(uniform.key + i, urlElementOrData));\n            } else {\n                this.uniformTexture(uniform.key, uniform.values[0]);\n            }\n        }\n        */\n\n        return uniform;\n      }\n    }, {\n      key: \"update\",\n      value: function update(method, type, key) {\n        var uniform = this.get(key);\n\n        for (var _len3 = arguments.length, values = new Array(_len3 > 3 ? _len3 - 3 : 0), _key3 = 3; _key3 < _len3; _key3++) {\n          values[_key3 - 3] = arguments[_key3];\n        }\n\n        if (uniform && (uniform.method !== method || uniform.type !== type || uniform.values !== values)) {\n          uniform.method = method;\n          uniform.type = type;\n          uniform.values = values;\n          uniform.dirty = true;\n          this.dirty = true;\n        }\n      }\n    }, {\n      key: \"createOrUpdate\",\n      value: function createOrUpdate(method, type, key) {\n        for (var _len4 = arguments.length, values = new Array(_len4 > 3 ? _len4 - 3 : 0), _key4 = 3; _key4 < _len4; _key4++) {\n          values[_key4 - 3] = arguments[_key4];\n        }\n\n        if (this.has(key)) {\n          this.update.apply(this, [method, type, key].concat(values));\n        } else {\n          this.create.apply(this, [method, type, key].concat(values));\n        }\n      }\n    }, {\n      key: \"apply\",\n      value: function apply(gl, program) {\n        this.forEach(function (uniform) {\n          return uniform.apply(gl, program);\n        });\n      }\n    }], [{\n      key: \"isArrayOfNumbers\",\n      value: function isArrayOfNumbers(array) {\n        return array.reduce(function (flag, value) {\n          return flag && typeof value === 'number';\n        }, true);\n      }\n    }, {\n      key: \"parseUniform\",\n      value: function parseUniform(key) {\n        for (var _len5 = arguments.length, values = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n          values[_key5 - 1] = arguments[_key5];\n        }\n\n        var value = values.length === 1 ? values[0] : values;\n        var uniform; // console.log(key, value);\n        // Single float\n\n        if (typeof value === 'number') {\n          uniform = new Uniform({\n            type: 'float',\n            method: '1f',\n            key: key,\n            values: [value]\n          });\n        } else if (typeof value === 'boolean') {\n          // Boolean\n          uniform = new Uniform({\n            type: 'bool',\n            method: '1i',\n            key: key,\n            values: [value]\n          });\n        } else if (textures_1.Texture.isTexture(value)) {\n          // Texture\n          uniform = new Uniform({\n            type: 'sampler2D',\n            method: '1i',\n            key: key,\n            values: value // !!!\n\n          });\n        } else if (Array.isArray(value)) {\n          // Array: vector, array of floats, array of textures, or array of structs\n          // Numeric values\n          if (Uniforms.isArrayOfNumbers(value)) {\n            // float vectors (vec2, vec3, vec4)\n            if (value.length === 1) {\n              uniform = new Uniform({\n                type: 'float',\n                method: '1f',\n                key: key,\n                values: value\n              });\n            } else if (value.length >= 2 && value.length <= 4) {\n              // float vectors (vec2, vec3, vec4)\n              uniform = new Uniform({\n                type: 'vec' + value.length,\n                method: value.length + 'fv',\n                key: key,\n                values: value\n              });\n            } else if (value.length > 4) {\n              // float array\n              uniform = new Uniform({\n                type: 'float[]',\n                method: '1fv',\n                key: key,\n                values: value\n              });\n            } // TODO: assume matrix for (typeof == Float32Array && length == 16)?\n\n          } else if (textures_1.Texture.getTextureOptions(value[0])) {\n            // Array of textures\n            uniform = new Uniform({\n              type: 'sampler2D',\n              method: '1iv',\n              key: key,\n              values: value\n            });\n          } else if (Array.isArray(value[0]) && typeof value[0][0] === 'number') {\n            // Array of arrays - but only arrays of vectors are allowed in this case\n            // float vectors (vec2, vec3, vec4)\n            if (value[0].length >= 2 && value[0].length <= 4) {\n              // Set each vector in the array\n              for (var u = 0; u < value.length; u++) {\n                uniform = new Uniform({\n                  type: 'vec' + value[0].length,\n                  method: value[u].length + 'fv',\n                  key: key + '[' + u + ']',\n                  values: value[u]\n                });\n              }\n            } // else error?\n\n          } else if (_typeof(value[0]) === 'object') {\n            // Array of structures\n            for (var _u = 0; _u < value.length; _u++) {// Set each struct in the array\n              // !!! uniform = new Uniform(...Uniforms.parseUniforms(value[u], key + '[' + u + ']'));\n            }\n          }\n        } else if (_typeof(value) === 'object') {} // Structure\n        // Set each field in the struct\n        // !!! uniform = new Uniform(...Uniforms.parseUniforms(value, key));\n        // TODO: support other non-float types? (int, etc.)\n\n\n        return uniform;\n      }\n    }, {\n      key: \"parseUniforms\",\n      value: function parseUniforms(values, prefix) {\n        var uniforms = new Map();\n\n        for (var key in values) {\n          var value = values[key];\n\n          if (prefix) {\n            key = prefix + '.' + key;\n          }\n\n          var uniform = Uniforms.parseUniform(key, value);\n\n          if (uniform) {\n            uniforms.set(key, uniform);\n          }\n        }\n\n        return uniforms;\n      }\n    }]);\n\n    return Uniforms;\n  }(_wrapNativeSuper(Map));\n\n  exports.default = Uniforms;\n});\n\n},{\"./textures\":6}]},{},[4]);\n\n//# sourceMappingURL=glsl-canvas.js.map\n"]}