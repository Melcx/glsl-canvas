{"version":3,"sources":["dist/glsl-canvas.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","this","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","marker","runClearTimeout","Item","array","noop","nextTick","args","Array","arguments","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","2","setImmediate","setTimeoutFunc","Promise","fn","TypeError","_state","_handled","_value","undefined","_deferreds","doResolve","handle","self","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","reject","promise","resolve","newValue","then","finale","thisArg","_unhandledRejectionFn","Handler","done","value","reason","ex","prom","constructor","callback","all","arr","slice","remaining","res","val","race","values","err","console","warn","timers","3","clearImmediate","Function","immediateIds","nextImmediateId","Timeout","id","clearFn","_id","_clearFn","window","setInterval","clearInterval","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","process/browser.js","4","_possibleConstructorReturn","_typeof","ReferenceError","_assertThisInitialized","_getPrototypeOf","Object","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","obj","Symbol","iterator","__importDefault","mod","__esModule","default","factory","v","define","amd","BufferFloatType","context_1","iterable_1","Buffer","gl","BW","BH","index","buffer","createFramebuffer","texture","getTexture","texParameteri","TEXTURE_2D","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","floatType","extension","FLOAT","getExtension","HALF_FLOAT","getFloatType","HALF_FLOAT_OES","createTexture","activeTexture","TEXTURE0","bindTexture","texImage2D","RGBA","checkFramebufferStatus","FRAMEBUFFER","FRAMEBUFFER_COMPLETE","bindFramebuffer","pixels","status","minW","Math","min","minH","Float32Array","readPixels","newIndex","newTexture","texSubImage2D","newBuffer","deleteTexture","IOBuffer","vertexString","fragmentString","isValid","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","createProgram","input","output","deleteShader","useProgram","viewport","framebufferTexture2D","COLOR_ATTACHMENT0","drawArrays","TRIANGLES","temp","resize","deleteProgram","Buffers","_iterable_1$default","subClass","superClass","create","_inherits","get","keys","buffers","count","matches","regexp","exec","drawingBufferWidth","drawingBufferHeight","set","./context","./iterable","5","Common","url","xhr","XMLHttpRequest","onload","response","responseText","onerror","ontimeout","onabort","open","send","promise-polyfill","6","ContextError","ContextDefaultVertex","ContextDefaultFragment","ContextVertexBuffers","Context","canvas","attributes","errorCallback","handleError","errorCode","html","container","parentNode","innerHTML","WebGLRenderingContext","BrowserSupport","context","getContext","Other","options","names","source","type","offset","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","lastError","getShaderInfoLog","error","shaders","locations","attachShader","_i","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","log","vertexBuffers","texcoordIndex","getAttribLocation","texcoord","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","positionIndex","position","7","_toConsumableArray","isArray","arr2","_arrayWithoutHoles","iter","toString","from","_iterableToArray","_nonIterableSpread","__importStar","result","k","hasOwnProperty","buffers_1","common_1","subscriber_1","textures_1","uniforms_1","GlslCanvasOptions","GlslCanvasTimer","delay","current","delta","paused","start","previous","now","performance","GlslCanvas","_subscriber_1$default","_this","contextOptions","mouse","x","y","uniforms","textures","textureList","valid","animated","dirty","visible","_removeListeners","width","height","rect","getBoundingClientRect","tryGetContext","onError","devicePixelRatio","style","backgroundColor","_getShaders","success","load","_addListeners","loop","items","_this2","urls","hasAttribute","vertex","getAttribute","fragment","map","fetch","body","_this3","scroll","click","toggle","trigger","move","mx","my","max","left","top","mousemove","clientX","pageX","clientY","pageY","mouseover","play","mouseout","pause","touchmove","touch","touches","reduce","touchend","document","removeEventListener","touchstart","addEventListener","time","checkRender","requestAnimationFrame","_uniforms_1$default","_this4","uniform","parseUniform","forEach","loadTexture","UniformType","Sampler2D","innerHeight","documentElement","clientHeight","timer","W","ceil","clientWidth","H","_this5","ext","split","pop","toLowerCase","TextureExtensions","indexOf","has","_this6","hasDelta","match","hasTime","hasDate","hasMouse","hasTextures","_parseTextures","classList","add","remove","UniformMethod","Uniform2f","FloatVec2","Uniform1f","Float","date","Date","Uniform4f","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","Uniform1i","next","update","_key","tryUpdate","getBuffers","createVertexBuffers","_createUniforms","_this7","query","createQueryEXT","wasValid","render","beginQueryEXT","TIME_ELAPSED_EXT","endQueryEXT","waitForTest","available","getQueryObjectEXT","QUERY_RESULT_AVAILABLE_EXT","disjoint","getParameter","GPU_DISJOINT_EXT","timeElapsedMs","QUERY_RESULT_EXT","destroy","_key2","splice","urlElementOrData","_this8","createOrUpdate","keyResolution","replace","_setUniform","_len","_key3","Int","setUniform","_isVisible","_sizeDidChanged","_isAnimated","_isDirty","_updateUniforms","clean","find","getElementsByClassName","filter","HTMLCanvasElement","of","loadAll","./buffers","./common","./subscriber","./textures","./uniforms","8","NumberMap","StringMap","IterableStringMap","callbackfn","initialValue","9","Listener","event","Subscriber","Set","listener","delete","clear","data","10","TextureSourceType","TextureFilteringType","TextureImageExtensions","TextureVideoExtensions","TextureData","TextureOptions","Texture","workpath","powerOf2","setData","Uint8Array","filtering","Linear","setUrl","element","setElement","sourceType","Url","assign","src","isVideo","createElement","setAttribute","autoplay","muted","Image","isSafari","crossOrigin","originalElement","querySelector","HTMLImageElement","HTMLVideoElement","Element","video","setFiltering","message","JSON","stringify","Data","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","naturalWidth","naturalHeight","UNSIGNED_BYTE","videoWidth","videoHeight","imageBuffer","isPowerOf2","MipMap","wrapS","repeat","REPEAT","wrapT","LINEAR_MIPMAP_LINEAR","LINEAR","generateMipmap","Nearest","test","navigator","userAgent","text","getTextureOptions","MAX_TEXTURE_SIZE","isTextureUrl","Textures","textureOptions","flag","11","Uniform","location","getUniformLocation","method","b","UniformTexture","_Uniform","Uniforms","Uniform1iv","Sampler2DArray","_len2","Differs","_len3","Number","isInteger","isTexture","_len4","_key4","isArrayOfInteger","Uniform2i","IntVec2","Uniform3i","IntVec3","Uniform4i","IntVec4","isArrayOfNumber","Uniform3f","FloatVec3","FloatVec4","isArrayOfBoolean","Bool","BoolVec2","BoolVec3","BoolVec4","IntArray","Uniform2iv","IntVec2Array","Uniform3iv","IntVec3Array","Uniform4iv","IntVec4Array","Uniform1fv","FloatArray","Uniform2fv","FloatVec2Array","Uniform3fv","FloatVec3Array","Uniform4fv","FloatVec4Array","BoolArray","BoolVec2Array","BoolVec3Array","BoolVec4Array","isArrayOfTexture"],"mappings":"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","file":"dist/glsl-canvas.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],2:[function(require,module,exports){\n(function (setImmediate){\n'use strict';\n\n/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = finallyConstructor;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nmodule.exports = Promise;\n\n}).call(this,require(\"timers\").setImmediate)\n},{\"timers\":3}],3:[function(require,module,exports){\n(function (setImmediate,clearImmediate){\nvar nextTick = require('process/browser.js').nextTick;\nvar apply = Function.prototype.apply;\nvar slice = Array.prototype.slice;\nvar immediateIds = {};\nvar nextImmediateId = 0;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) { timeout.close(); };\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// That's not how node.js implements it but the exposed api is the same.\nexports.setImmediate = typeof setImmediate === \"function\" ? setImmediate : function(fn) {\n  var id = nextImmediateId++;\n  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n\n  immediateIds[id] = true;\n\n  nextTick(function onNextTick() {\n    if (immediateIds[id]) {\n      // fn.call() is faster so we optimize for the common use-case\n      // @see http://jsperf.com/call-apply-segu\n      if (args) {\n        fn.apply(null, args);\n      } else {\n        fn.call(null);\n      }\n      // Prevent ids from leaking\n      exports.clearImmediate(id);\n    }\n  });\n\n  return id;\n};\n\nexports.clearImmediate = typeof clearImmediate === \"function\" ? clearImmediate : function(id) {\n  delete immediateIds[id];\n};\n}).call(this,require(\"timers\").setImmediate,require(\"timers\").clearImmediate)\n},{\"process/browser.js\":1,\"timers\":3}],4:[function(require,module,exports){\n\"use strict\";\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"./context\", \"./iterable\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var context_1 = __importDefault(require(\"./context\"));\n\n  var iterable_1 = __importDefault(require(\"./iterable\"));\n\n  var BufferFloatType;\n\n  (function (BufferFloatType) {\n    BufferFloatType[BufferFloatType[\"FLOAT\"] = 0] = \"FLOAT\";\n    BufferFloatType[BufferFloatType[\"HALF_FLOAT\"] = 1] = \"HALF_FLOAT\";\n  })(BufferFloatType = exports.BufferFloatType || (exports.BufferFloatType = {}));\n\n  var Buffer =\n  /*#__PURE__*/\n  function () {\n    function Buffer(gl, BW, BH, index) {\n      _classCallCheck(this, Buffer);\n\n      var buffer = gl.createFramebuffer();\n      var texture = this.getTexture(gl, BW, BH, index);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      this.texture = texture;\n      this.buffer = buffer;\n      this.BW = BW;\n      this.BH = BH;\n      this.index = index;\n    }\n\n    _createClass(Buffer, [{\n      key: \"getFloatType\",\n      value: function getFloatType(gl) {\n        var floatType, extension;\n\n        if (Buffer.floatType === BufferFloatType.FLOAT) {\n          extension = gl.getExtension('OES_texture_float');\n\n          if (extension) {\n            floatType = gl.FLOAT;\n          } else {\n            Buffer.floatType = BufferFloatType.HALF_FLOAT;\n            return this.getFloatType(gl);\n          }\n        } else {\n          extension = gl.getExtension('OES_texture_half_float');\n\n          if (extension) {\n            floatType = extension.HALF_FLOAT_OES;\n          } else {\n            Buffer.floatType = BufferFloatType.FLOAT;\n            return this.getFloatType(gl);\n          }\n        }\n\n        return floatType;\n      }\n    }, {\n      key: \"getTexture\",\n      value: function getTexture(gl, BW, BH, index) {\n        var floatType = this.getFloatType(gl);\n        var texture = gl.createTexture();\n        gl.activeTexture(gl.TEXTURE0 + index);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, BW, BH, 0, gl.RGBA, floatType, null);\n        var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n\n        if (status !== gl.FRAMEBUFFER_COMPLETE) {\n          if (Buffer.floatType === BufferFloatType.FLOAT) {\n            Buffer.floatType = BufferFloatType.HALF_FLOAT;\n          } else {\n            Buffer.floatType = BufferFloatType.FLOAT;\n          }\n\n          return this.getTexture(gl, BW, BH, index);\n        }\n\n        return texture;\n      }\n    }, {\n      key: \"resize\",\n      value: function resize(gl, BW, BH) {\n        if (BW !== this.BW || BH !== this.BH) {\n          var buffer = this.buffer;\n          var texture = this.texture;\n          var index = this.index;\n          gl.bindFramebuffer(gl.FRAMEBUFFER, buffer);\n          var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n          var minW = Math.min(BW, this.BW);\n          var minH = Math.min(BH, this.BH);\n          var pixels;\n          var floatType = this.getFloatType(gl);\n\n          if (status === gl.FRAMEBUFFER_COMPLETE) {\n            pixels = new Float32Array(minW * minH * 4);\n            gl.readPixels(0, 0, minW, minH, gl.RGBA, floatType, pixels);\n          }\n\n          gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n          var newIndex = index + 1; // temporary index\n\n          var newTexture = this.getTexture(gl, BW, BH, newIndex);\n          floatType = this.getFloatType(gl);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n          if (pixels) {\n            gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, minW, minH, gl.RGBA, floatType, pixels);\n          }\n\n          var newBuffer = gl.createFramebuffer();\n          gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n          gl.deleteTexture(texture);\n          gl.activeTexture(gl.TEXTURE0 + index);\n          gl.bindTexture(gl.TEXTURE_2D, newTexture);\n          this.index = index;\n          this.texture = newTexture;\n          this.buffer = newBuffer;\n          this.BW = BW;\n          this.BH = BH;\n        }\n      }\n    }]);\n\n    return Buffer;\n  }();\n\n  Buffer.floatType = BufferFloatType.HALF_FLOAT;\n  exports.Buffer = Buffer;\n\n  var IOBuffer =\n  /*#__PURE__*/\n  function () {\n    function IOBuffer(index, key, vertexString, fragmentString) {\n      _classCallCheck(this, IOBuffer);\n\n      this.isValid = false;\n      this.index = index;\n      this.key = key;\n      this.vertexString = vertexString;\n      this.fragmentString = fragmentString;\n    }\n\n    _createClass(IOBuffer, [{\n      key: \"create\",\n      value: function create(gl, BW, BH) {\n        var vertexShader = context_1.default.createShader(gl, this.vertexString, gl.VERTEX_SHADER);\n        var fragmentShader = context_1.default.createShader(gl, this.fragmentString, gl.FRAGMENT_SHADER, 1);\n\n        if (!fragmentShader) {\n          fragmentShader = context_1.default.createShader(gl, 'void main(){\\n\\tgl_FragColor = vec4(1.0);\\n}', gl.FRAGMENT_SHADER);\n          this.isValid = false;\n        } else {\n          this.isValid = true;\n        }\n\n        var program = context_1.default.createProgram(gl, [vertexShader, fragmentShader]); // gl.useProgram(program);\n\n        var input = new Buffer(gl, BW, BH, this.index + 0);\n        var output = new Buffer(gl, BW, BH, this.index + 2);\n        this.program = program;\n        this.input = input;\n        this.output = output;\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n      }\n    }, {\n      key: \"render\",\n      value: function render(gl, BW, BH) {\n        gl.useProgram(this.program);\n        gl.viewport(0, 0, BW, BH);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.output.buffer);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.output.texture, 0);\n        gl.drawArrays(gl.TRIANGLES, 0, 6); // swap\n\n        var temp = this.input;\n        var input = this.output;\n        var output = temp;\n        this.input = input;\n        this.output = output;\n      }\n    }, {\n      key: \"resize\",\n      value: function resize(gl, BW, BH) {\n        gl.useProgram(this.program);\n        gl.viewport(0, 0, BW, BH);\n        this.input.resize(gl, BW, BH);\n        this.output.resize(gl, BW, BH);\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy(gl) {\n        gl.deleteProgram(this.program);\n        this.program = null;\n        this.input = null;\n        this.output = null;\n      }\n    }]);\n\n    return IOBuffer;\n  }();\n\n  exports.IOBuffer = IOBuffer;\n\n  var Buffers =\n  /*#__PURE__*/\n  function (_iterable_1$default) {\n    _inherits(Buffers, _iterable_1$default);\n\n    function Buffers() {\n      _classCallCheck(this, Buffers);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(Buffers).apply(this, arguments));\n    }\n\n    _createClass(Buffers, [{\n      key: \"count\",\n      get: function get() {\n        return Object.keys(this.values).length * 4;\n      }\n    }], [{\n      key: \"getBuffers\",\n      value: function getBuffers(gl, fragmentString, vertexString) {\n        var buffers = new Buffers();\n        var count = 0;\n\n        if (fragmentString) {\n          var regexp = /(?:^\\s*)((?:#if|#elif)(?:\\s*)(defined\\s*\\(\\s*BUFFER_)(\\d+)(?:\\s*\\))|(?:#ifdef)(?:\\s*BUFFER_)(\\d+)(?:\\s*))/gm;\n          var matches;\n\n          while ((matches = regexp.exec(fragmentString)) !== null) {\n            var i = matches[3] || matches[4];\n            var key = 'u_buffer' + i;\n            var buffer = new IOBuffer(count, key, vertexString, '#define BUFFER_' + i + '\\n' + fragmentString);\n            buffer.create(gl, gl.drawingBufferWidth, gl.drawingBufferHeight);\n            buffers.set(key, buffer);\n            count += 4;\n          }\n        }\n\n        return buffers;\n      }\n    }]);\n\n    return Buffers;\n  }(iterable_1.default);\n\n  exports.default = Buffers;\n});\n\n},{\"./context\":6,\"./iterable\":8}],5:[function(require,module,exports){\n\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"promise-polyfill\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  require(\"promise-polyfill\");\n\n  var Common =\n  /*#__PURE__*/\n  function () {\n    function Common() {\n      _classCallCheck(this, Common);\n    }\n\n    _createClass(Common, null, [{\n      key: \"fetch\",\n      value: function fetch(url) {\n        return new Promise(function (resolve, reject) {\n          var xhr = new XMLHttpRequest();\n\n          xhr.onload = function () {\n            resolve(xhr.response || xhr.responseText);\n          };\n\n          xhr.onerror = function () {\n            reject(new Error('Network request failed'));\n          };\n\n          xhr.ontimeout = function () {\n            reject(new Error('Network request failed'));\n          };\n\n          xhr.onabort = function () {\n            reject(new Error('Aborted'));\n          };\n\n          xhr.open('GET', url, true);\n          xhr.send(null);\n        });\n      }\n    }]);\n\n    return Common;\n  }();\n\n  exports.default = Common;\n});\n\n},{\"promise-polyfill\":2}],6:[function(require,module,exports){\n\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.ContextDefaultVertex = \"\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texcoord;\\n\\nvarying vec2 v_texcoord;\\n\\nvoid main(){\\n\\tgl_Position = vec4(a_position, 0.0, 1.0);\\n\\tv_texcoord = a_texcoord;\\n}\\n\";\n  exports.ContextDefaultFragment = \"\\n#ifdef GL_ES\\nprecision mediump float;\\n#endif\\n\\nvarying vec2 v_texcoord;\\n\\nvoid main(){\\n\\tgl_FragColor = vec4(0.0);\\n}\\n\";\n  var ContextError;\n\n  (function (ContextError) {\n    ContextError[ContextError[\"BrowserSupport\"] = 1] = \"BrowserSupport\";\n    ContextError[ContextError[\"Other\"] = 2] = \"Other\";\n  })(ContextError = exports.ContextError || (exports.ContextError = {}));\n\n  var ContextVertexBuffers = function ContextVertexBuffers() {\n    _classCallCheck(this, ContextVertexBuffers);\n  };\n\n  exports.ContextVertexBuffers = ContextVertexBuffers;\n\n  var Context =\n  /*#__PURE__*/\n  function () {\n    function Context() {\n      _classCallCheck(this, Context);\n    }\n\n    _createClass(Context, null, [{\n      key: \"tryGetContext\",\n      value: function tryGetContext(canvas, attributes, errorCallback) {\n        function handleError(errorCode, html) {\n          if (typeof errorCallback === 'function') {\n            errorCallback(errorCode);\n          } else {\n            var container = canvas.parentNode;\n\n            if (container) {\n              container.innerHTML = \"<div class=\\\"glsl-canvas--error\\\">\".concat(html, \"</div>\");\n            }\n          }\n        }\n\n        if (!WebGLRenderingContext) {\n          handleError(ContextError.BrowserSupport, \"This page requires a browser that supports WebGL.<br/>\\n\\t\\t\\t<a href=\\\"http://get.webgl.org\\\">Click here to upgrade your browser.</a>\");\n          return null;\n        }\n\n        var context = Context.getContext(canvas, attributes);\n\n        if (!context) {\n          handleError(ContextError.Other, \"It does not appear your computer can support WebGL.<br/>\\n\\t\\t\\t<a href=\\\"http://get.webgl.org/troubleshooting/\\\">Click here for more information.</a>\");\n        } else {\n          context.getExtension('OES_standard_derivatives');\n        }\n\n        return context;\n      }\n    }, {\n      key: \"getContext\",\n      value: function getContext(canvas, options) {\n        var names = ['webgl', 'experimental-webgl'];\n        var context = null;\n\n        for (var i = 0; i < names.length; ++i) {\n          try {\n            context = canvas.getContext(names[i], options);\n          } catch (e) {\n            if (context) {\n              break;\n            }\n          }\n        }\n\n        return context;\n      }\n    }, {\n      key: \"createShader\",\n      value: function createShader(gl, source, type) {\n        var offset = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var shader = gl.createShader(type);\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n        var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n\n        if (!compiled) {\n          // Something went wrong during compilation; get the error\n          Context.lastError = gl.getShaderInfoLog(shader);\n          console.error('*** Error compiling shader ' + shader + ':' + Context.lastError); // main.trigger('error', {\n\n          gl.deleteShader(shader);\n          throw {\n            shader: shader,\n            source: source,\n            type: type,\n            error: Context.lastError,\n            offset: offset\n          };\n        }\n\n        return shader;\n      }\n    }, {\n      key: \"createProgram\",\n      value: function createProgram(gl, shaders, attributes, locations) {\n        var program = gl.createProgram();\n\n        for (var i = 0; i < shaders.length; ++i) {\n          gl.attachShader(program, shaders[i]);\n        }\n\n        if (attributes && locations) {\n          for (var _i = 0; _i < attributes.length; ++_i) {\n            gl.bindAttribLocation(program, locations ? locations[_i] : _i, attributes[_i]);\n          }\n        }\n\n        gl.linkProgram(program); // Check the link status\n\n        var linked = gl.getProgramParameter(program, gl.LINK_STATUS);\n\n        if (!linked) {\n          // something went wrong with the link\n          Context.lastError = gl.getProgramInfoLog(program);\n          console.log('Error in program linking:' + Context.lastError);\n          gl.deleteProgram(program);\n          return null;\n        }\n\n        return program;\n      }\n    }, {\n      key: \"createVertexBuffers\",\n      value: function createVertexBuffers(gl, program) {\n        var vertexBuffers = new ContextVertexBuffers();\n        var texcoordIndex = gl.getAttribLocation(program, 'a_texcoord');\n        vertexBuffers.texcoord = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffers.texcoord);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), gl.STATIC_DRAW);\n        gl.enableVertexAttribArray(texcoordIndex);\n        gl.vertexAttribPointer(texcoordIndex, 2, gl.FLOAT, false, 0, 0);\n        var positionIndex = gl.getAttribLocation(program, 'a_position');\n        vertexBuffers.position = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffers.position);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, 1.0]), gl.STATIC_DRAW);\n        gl.enableVertexAttribArray(positionIndex);\n        gl.vertexAttribPointer(positionIndex, 2, gl.FLOAT, false, 0, 0);\n        return vertexBuffers;\n      }\n    }]);\n\n    return Context;\n  }();\n\n  Context.lastError = '';\n  exports.default = Context;\n});\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar __importStar = void 0 && (void 0).__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  }\n  result[\"default\"] = mod;\n  return result;\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"promise-polyfill\", \"./buffers\", \"./common\", \"./context\", \"./subscriber\", \"./textures\", \"./uniforms\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  }); // import '@babel/polyfill';\n\n  require(\"promise-polyfill\");\n\n  var buffers_1 = __importDefault(require(\"./buffers\"));\n\n  var common_1 = __importDefault(require(\"./common\"));\n\n  var context_1 = __importStar(require(\"./context\"));\n\n  var subscriber_1 = __importDefault(require(\"./subscriber\"));\n\n  var textures_1 = __importStar(require(\"./textures\"));\n\n  var uniforms_1 = __importStar(require(\"./uniforms\"));\n\n  var GlslCanvasOptions = function GlslCanvasOptions() {\n    _classCallCheck(this, GlslCanvasOptions);\n  };\n\n  exports.GlslCanvasOptions = GlslCanvasOptions;\n\n  var GlslCanvasTimer =\n  /*#__PURE__*/\n  function () {\n    function GlslCanvasTimer() {\n      _classCallCheck(this, GlslCanvasTimer);\n\n      this.delay = 0.0;\n      this.current = 0.0;\n      this.delta = 0.0;\n      this.paused = false;\n      this.start = this.previous = this.now();\n    }\n\n    _createClass(GlslCanvasTimer, [{\n      key: \"now\",\n      value: function now() {\n        return performance.now();\n      }\n    }, {\n      key: \"play\",\n      value: function play() {\n        if (this.previous) {\n          var now = this.now();\n          this.delay += now - this.previous;\n          this.previous = now;\n        } // console.log(this.delay);\n\n\n        this.paused = false;\n      }\n    }, {\n      key: \"pause\",\n      value: function pause() {\n        this.paused = true;\n      }\n    }, {\n      key: \"next\",\n      value: function next() {\n        var now = this.now();\n        this.delta = now - this.previous;\n        this.current = now - this.start - this.delay;\n        this.previous = now;\n        return this;\n      }\n    }]);\n\n    return GlslCanvasTimer;\n  }();\n\n  exports.GlslCanvasTimer = GlslCanvasTimer;\n\n  var GlslCanvas =\n  /*#__PURE__*/\n  function (_subscriber_1$default) {\n    _inherits(GlslCanvas, _subscriber_1$default);\n\n    function GlslCanvas(canvas) {\n      var _this;\n\n      var contextOptions = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {// alpha: true,\n        // antialias: true,\n        // premultipliedAlpha: true\n      };\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      _classCallCheck(this, GlslCanvas);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(GlslCanvas).call(this));\n      _this.mouse = {\n        x: 0,\n        y: 0\n      };\n      _this.uniforms = new uniforms_1.default();\n      _this.buffers = new buffers_1.default();\n      _this.textures = new textures_1.default();\n      _this.textureList = [];\n      _this.valid = false;\n      _this.animated = false;\n      _this.dirty = true;\n      _this.visible = false;\n\n      _this._removeListeners = function () {};\n\n      if (!canvas) {\n        return _possibleConstructorReturn(_this);\n      }\n\n      _this.canvas = canvas;\n      _this.width = 0; // canvas.clientWidth;\n\n      _this.height = 0; // canvas.clientHeight;\n\n      _this.rect = canvas.getBoundingClientRect();\n      _this.vertexString = contextOptions.vertexString || context_1.ContextDefaultVertex;\n      _this.fragmentString = contextOptions.fragmentString || context_1.ContextDefaultFragment;\n      var gl = context_1.default.tryGetContext(canvas, contextOptions, options.onError);\n\n      if (!gl) {\n        return _possibleConstructorReturn(_this);\n      }\n\n      _this.gl = gl;\n      _this.devicePixelRatio = window.devicePixelRatio || 1;\n      canvas.style.backgroundColor = contextOptions.backgroundColor || 'rgba(0,0,0,0)';\n\n      _this._getShaders().then(function (success) {\n        _this.load();\n\n        if (!_this.program) {\n          return;\n        }\n\n        _this._addListeners();\n\n        _this.loop(); // this.animated = false;\n\n      }, function (error) {\n        console.log('error', error);\n      });\n\n      GlslCanvas.items.push(_assertThisInitialized(_assertThisInitialized(_this)));\n      return _this;\n    }\n\n    _createClass(GlslCanvas, [{\n      key: \"_getShaders\",\n      value: function _getShaders() {\n        var _this2 = this;\n\n        return new Promise(function (resolve, reject) {\n          var canvas = _this2.canvas;\n          var urls = {};\n\n          if (canvas.hasAttribute('data-vertex-url')) {\n            urls.vertex = canvas.getAttribute('data-vertex-url');\n          }\n\n          if (canvas.hasAttribute('data-fragment-url')) {\n            urls.fragment = canvas.getAttribute('data-fragment-url');\n          }\n\n          if (canvas.hasAttribute('data-vertex')) {\n            _this2.vertexString = canvas.getAttribute('data-vertex');\n          }\n\n          if (canvas.hasAttribute('data-fragment')) {\n            _this2.fragmentString = canvas.getAttribute('data-fragment');\n          }\n\n          if (Object.keys(urls).length) {\n            Promise.all(Object.keys(urls).map(function (key, i) {\n              var url = urls[key];\n              return common_1.default.fetch(url) // .then((response) => response.text())\n              .then(function (body) {\n                if (key === 'vertex') {\n                  return _this2.vertexString = body;\n                } else {\n                  return _this2.fragmentString = body;\n                }\n              });\n            })).then(function (shaders) {\n              resolve([_this2.vertexString, _this2.fragmentString]);\n            });\n          } else {\n            resolve([_this2.vertexString, _this2.fragmentString]);\n          }\n        });\n      }\n    }, {\n      key: \"_addListeners\",\n      value: function _addListeners() {\n        var _this3 = this;\n\n        /*\n        const resize = (e: Event) => {\n            this.rect = this.canvas.getBoundingClientRect();\n            this.trigger('resize', e);\n        };\n        */\n        var scroll = function scroll(e) {\n          _this3.rect = _this3.canvas.getBoundingClientRect();\n        };\n\n        var click = function click(e) {\n          _this3.toggle();\n\n          _this3.trigger('click', e);\n        };\n\n        var move = function move(mx, my) {\n          var rect = _this3.rect,\n              gap = 20;\n          var x = Math.max(-gap, Math.min(rect.width + gap, (mx - rect.left) * _this3.devicePixelRatio));\n          var y = Math.max(-gap, Math.min(rect.height + gap, _this3.canvas.height - (my - rect.top) * _this3.devicePixelRatio));\n\n          if (x !== _this3.mouse.x || y !== _this3.mouse.y) {\n            _this3.mouse.x = x;\n            _this3.mouse.y = y;\n\n            _this3.trigger('move', _this3.mouse);\n          }\n        };\n\n        var mousemove = function mousemove(e) {\n          move(e.clientX || e.pageX, e.clientY || e.pageY);\n        };\n\n        var mouseover = function mouseover(e) {\n          _this3.play();\n\n          _this3.trigger('over', e);\n        };\n\n        var mouseout = function mouseout(e) {\n          _this3.pause();\n\n          _this3.trigger('out', e);\n        };\n\n        var touchmove = function touchmove(e) {\n          var touch = [].slice.call(e.touches).reduce(function (p, touch) {\n            p = p || {\n              x: 0,\n              y: 0\n            };\n            p.x += touch.clientX;\n            p.y += touch.clientY;\n            return p;\n          }, null);\n\n          if (touch) {\n            move(touch.x / e.touches.length, touch.y / e.touches.length);\n          }\n        };\n\n        var touchend = function touchend(e) {\n          _this3.pause();\n\n          _this3.trigger('out', e);\n\n          document.removeEventListener('touchend', touchend);\n        };\n\n        var touchstart = function touchstart(e) {\n          _this3.play();\n\n          _this3.trigger('over', e);\n\n          document.addEventListener('touchend', touchend);\n          document.removeEventListener('mousemove', mousemove);\n\n          if (_this3.canvas.hasAttribute('controls')) {\n            _this3.canvas.removeEventListener('mouseover', mouseover);\n\n            _this3.canvas.removeEventListener('mouseout', mouseout);\n          }\n        };\n\n        var loop = function loop(time) {\n          _this3.checkRender();\n\n          window.requestAnimationFrame(loop);\n        };\n\n        this.loop = loop; // window.addEventListener('resize', resize);\n\n        window.addEventListener('scroll', scroll);\n        document.addEventListener('mousemove', mousemove, false);\n        document.addEventListener('touchmove', touchmove);\n\n        if (this.canvas.hasAttribute('controls')) {\n          this.canvas.addEventListener('click', click);\n          this.canvas.addEventListener('mouseover', mouseover);\n          this.canvas.addEventListener('mouseout', mouseout);\n          this.canvas.addEventListener('touchstart', touchstart);\n\n          if (!this.canvas.hasAttribute('data-autoplay')) {\n            this.pause();\n          }\n        }\n\n        this._removeListeners = function () {\n          // window.removeEventListener('resize', resize);\n          window.removeEventListener('scroll', scroll);\n          document.removeEventListener('mousemove', mousemove);\n          document.removeEventListener('touchmove', touchmove);\n\n          if (_this3.canvas.hasAttribute('controls')) {\n            _this3.canvas.removeEventListener('click', click);\n\n            _this3.canvas.removeEventListener('mouseover', mouseover);\n\n            _this3.canvas.removeEventListener('mouseout', mouseout);\n\n            _this3.canvas.removeEventListener('touchstart', touchstart);\n          }\n        };\n      }\n    }, {\n      key: \"_setUniform\",\n      value: function _setUniform(key, values) {\n        var _uniforms_1$default,\n            _this4 = this;\n\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n        var type = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n        var uniform = (_uniforms_1$default = uniforms_1.default).parseUniform.apply(_uniforms_1$default, [key].concat(_toConsumableArray(values)));\n\n        if (Array.isArray(uniform)) {\n          uniform.forEach(function (x) {\n            return _this4.loadTexture(x.key, x.values[0], options);\n          });\n          /*\n          if (Uniforms.isArrayOfSampler2D(uniform)) {\n              uniform.forEach((x) => this.loadTexture(x.key, x.values[0], options));\n          } else {\n              uniform.forEach((x) => this.uniforms.set(x.key, x.values[0]));\n          }\n          */\n        } else if (uniform) {\n          switch (uniform.type) {\n            case uniforms_1.UniformType.Sampler2D:\n              this.loadTexture(key, values[0]);\n              break;\n\n            default:\n              this.uniforms.set(key, uniform);\n          }\n        }\n      }\n    }, {\n      key: \"_isVisible\",\n      value: function _isVisible() {\n        var rect = this.rect;\n        return rect.top + rect.height > 0 && rect.top < (window.innerHeight || document.documentElement.clientHeight);\n      }\n    }, {\n      key: \"_isAnimated\",\n      value: function _isAnimated() {\n        return (this.animated || this.textures.animated) && !this.timer.paused;\n      }\n    }, {\n      key: \"_isDirty\",\n      value: function _isDirty() {\n        return this.dirty || this.uniforms.dirty || this.textures.dirty;\n      } // check size change at start of requestFrame\n\n    }, {\n      key: \"_sizeDidChanged\",\n      value: function _sizeDidChanged() {\n        var gl = this.gl;\n        var W = Math.ceil(this.canvas.clientWidth),\n            H = Math.ceil(this.canvas.clientHeight);\n\n        if (this.width !== W || this.height !== H) {\n          this.width = W;\n          this.height = H; // Lookup the size the browser is displaying the canvas in CSS pixels\n          // and compute a size needed to make our drawingbuffer match it in\n          // device pixels.\n\n          var BW = Math.ceil(W * this.devicePixelRatio);\n          var BH = Math.ceil(H * this.devicePixelRatio);\n          this.canvas.width = BW;\n          this.canvas.height = BH;\n          /*\n          if (gl.canvas.width !== BW ||\n              gl.canvas.height !== BH) {\n              gl.canvas.width = BW;\n              gl.canvas.height = BH;\n              // Set the viewport to match\n              // gl.viewport(0, 0, BW, BH);\n          }\n          */\n\n          for (var key in this.buffers.values) {\n            var buffer = this.buffers.values[key];\n            buffer.resize(gl, BW, BH);\n          }\n\n          this.rect = this.canvas.getBoundingClientRect();\n          this.trigger('resize'); // gl.useProgram(this.program);\n\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }, {\n      key: \"_parseTextures\",\n      value: function _parseTextures(fragmentString) {\n        var _this5 = this;\n\n        var regexp = /uniform\\s*sampler2D\\s*([\\w]*);(\\s*\\/\\/\\s*([\\w|\\:\\/\\/|\\.|\\-|\\_]*)|\\s*)/gm;\n        var matches;\n\n        while ((matches = regexp.exec(fragmentString)) !== null) {\n          var key = matches[1];\n\n          if (matches[3]) {\n            var ext = matches[3].split('.').pop().toLowerCase();\n            var url = matches[3];\n\n            if (url && textures_1.TextureExtensions.indexOf(ext) !== -1) {\n              this.textureList.push({\n                key: key,\n                url: url\n              });\n            }\n          } else if (!this.buffers.has(key)) {\n            // create empty texture\n            this.textureList.push({\n              key: key,\n              url: null\n            });\n          }\n        }\n\n        if (this.canvas.hasAttribute('data-textures')) {\n          var urls = this.canvas.getAttribute('data-textures').split(',');\n          urls.forEach(function (url, i) {\n            var key = 'u_texture' + i;\n\n            _this5.textureList.push({\n              key: key,\n              url: url\n            });\n          });\n        }\n\n        return this.textureList.length > 0;\n      }\n    }, {\n      key: \"_createUniforms\",\n      value: function _createUniforms() {\n        var _this6 = this;\n\n        var gl = this.gl;\n        var fragmentString = this.fragmentString;\n        var BW = gl.drawingBufferWidth;\n        var BH = gl.drawingBufferHeight;\n        var timer = this.timer = new GlslCanvasTimer();\n        var hasDelta = (fragmentString.match(/u_delta/g) || []).length > 1;\n        var hasTime = (fragmentString.match(/u_time/g) || []).length > 1;\n        var hasDate = (fragmentString.match(/u_date/g) || []).length > 1;\n        var hasMouse = (fragmentString.match(/u_mouse/g) || []).length > 1;\n\n        var hasTextures = this._parseTextures(fragmentString);\n\n        this.animated = hasTime || hasDate || hasMouse;\n\n        if (this.animated) {\n          this.canvas.classList.add('animated');\n        } else {\n          this.canvas.classList.remove('animated');\n        }\n\n        this.uniforms.create(uniforms_1.UniformMethod.Uniform2f, uniforms_1.UniformType.FloatVec2, 'u_resolution', BW, BH);\n\n        if (hasDelta) {\n          this.uniforms.create(uniforms_1.UniformMethod.Uniform1f, uniforms_1.UniformType.Float, 'u_delta', timer.delta / 1000.0);\n        }\n\n        if (hasTime) {\n          this.uniforms.create(uniforms_1.UniformMethod.Uniform1f, uniforms_1.UniformType.Float, 'u_time', timer.current / 1000.0);\n        }\n\n        if (hasDate) {\n          var date = new Date();\n          this.uniforms.create(uniforms_1.UniformMethod.Uniform4f, uniforms_1.UniformType.Float, 'u_date', date.getFullYear(), date.getMonth(), date.getDate(), date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds() + date.getMilliseconds() * 0.001);\n        }\n\n        if (hasMouse) {\n          this.uniforms.create(uniforms_1.UniformMethod.Uniform2f, uniforms_1.UniformType.FloatVec2, 'u_mouse', 0, 0);\n        }\n\n        for (var key in this.buffers.values) {\n          var buffer = this.buffers.values[key];\n          this.uniforms.create(uniforms_1.UniformMethod.Uniform1i, uniforms_1.UniformType.Sampler2D, buffer.key, buffer.input.index);\n        }\n\n        if (hasTextures) {\n          this.textureList.forEach(function (x) {\n            _this6.loadTexture(x.key, x.url);\n          });\n          this.textureList = [];\n        }\n      }\n    }, {\n      key: \"_updateUniforms\",\n      value: function _updateUniforms() {\n        var gl = this.gl;\n        var BW = gl.drawingBufferWidth;\n        var BH = gl.drawingBufferHeight;\n        var timer = this.timer.next();\n        this.uniforms.update(uniforms_1.UniformMethod.Uniform2f, uniforms_1.UniformType.FloatVec2, 'u_resolution', BW, BH);\n\n        if (this.uniforms.has('u_delta')) {\n          this.uniforms.update(uniforms_1.UniformMethod.Uniform1f, uniforms_1.UniformType.Float, 'u_delta', timer.delta / 1000.0);\n        }\n\n        if (this.uniforms.has('u_time')) {\n          this.uniforms.update(uniforms_1.UniformMethod.Uniform1f, uniforms_1.UniformType.Float, 'u_time', timer.current / 1000.0);\n        }\n\n        if (this.uniforms.has('u_date')) {\n          var date = new Date();\n          this.uniforms.update(uniforms_1.UniformMethod.Uniform4f, uniforms_1.UniformType.Float, 'u_date', date.getFullYear(), date.getMonth(), date.getDate(), date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds() + date.getMilliseconds() * 0.001);\n        }\n\n        if (this.uniforms.has('u_mouse')) {\n          var mouse = this.mouse;\n          this.uniforms.update(uniforms_1.UniformMethod.Uniform2f, uniforms_1.UniformType.FloatVec2, 'u_mouse', mouse.x, mouse.y);\n          /*\n          const rect = this.rect;\n          if (mouse.x >= rect.left && mouse.x <= rect.right &&\n              mouse.y >= rect.top && mouse.y <= rect.bottom) {\n              const MX = (mouse.x - rect.left) * this.devicePixelRatio;\n              const MY = (this.canvas.height - (mouse.y - rect.top) * this.devicePixelRatio);\n              this.uniforms.update(UniformMethod.Uniform2f, UniformType.FloatVec2, 'u_mouse', MX, MY);\n          }\n          */\n        }\n\n        for (var key in this.buffers.values) {\n          var buffer = this.buffers.values[key];\n          this.uniforms.update(uniforms_1.UniformMethod.Uniform1i, uniforms_1.UniformType.Sampler2D, buffer.key, buffer.input.index);\n        }\n\n        for (var _key in this.textures.values) {\n          var texture = this.textures.values[_key];\n          texture.tryUpdate(gl);\n          this.uniforms.update(uniforms_1.UniformMethod.Uniform1i, uniforms_1.UniformType.Sampler2D, texture.key, texture.index);\n        }\n      }\n    }, {\n      key: \"load\",\n      value: function load(fragmentString, vertexString) {\n        if (vertexString) {\n          this.vertexString = vertexString;\n        }\n\n        if (fragmentString) {\n          this.fragmentString = fragmentString;\n        }\n\n        var gl = this.gl;\n        var vertexShader, fragmentShader;\n\n        try {\n          vertexShader = context_1.default.createShader(gl, this.vertexString, gl.VERTEX_SHADER);\n          fragmentShader = context_1.default.createShader(gl, this.fragmentString, gl.FRAGMENT_SHADER); // If Fragment shader fails load a empty one to sign the error\n\n          if (!fragmentShader) {\n            fragmentShader = context_1.default.createShader(gl, context_1.ContextDefaultFragment, gl.FRAGMENT_SHADER);\n            this.valid = false;\n          } else {\n            this.valid = true;\n          }\n        } catch (e) {\n          this.trigger('error', e);\n          return;\n        } // Create and use program\n\n\n        var program = context_1.default.createProgram(gl, [vertexShader, fragmentShader]); //, [0,1],['a_texcoord','a_position']);\n\n        gl.useProgram(program); // Delete shaders\n        // gl.detachShader(program, vertexShader);\n        // gl.detachShader(program, fragmentShader);\n\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n        this.program = program;\n\n        if (this.valid) {\n          this.buffers = buffers_1.default.getBuffers(gl, this.fragmentString, this.vertexString);\n          this.vertexBuffers = context_1.default.createVertexBuffers(gl, program);\n\n          this._createUniforms();\n        } // Trigger event\n\n\n        this.trigger('load', this);\n      }\n    }, {\n      key: \"test\",\n      value: function test(fragmentString, vertexString) {\n        var _this7 = this;\n\n        return new Promise(function (resolve, reject) {\n          var vertex = _this7.vertexString;\n          var fragment = _this7.fragmentString;\n          var paused = _this7.timer.paused; // Thanks to @thespite for the help here\n          // https://www.khronos.org/registry/webgl/extensions/EXT_disjoint_timer_query/\n\n          var extension = _this7.gl.getExtension('EXT_disjoint_timer_query');\n\n          var query = extension.createQueryEXT();\n          var wasValid = _this7.valid;\n\n          if (fragmentString || vertexString) {\n            _this7.load(fragmentString, vertexString);\n\n            wasValid = _this7.valid;\n\n            _this7.render();\n          }\n\n          _this7.timer.paused = true;\n          extension.beginQueryEXT(extension.TIME_ELAPSED_EXT, query);\n\n          _this7.render();\n\n          extension.endQueryEXT(extension.TIME_ELAPSED_EXT);\n\n          var waitForTest = function waitForTest() {\n            _this7.render();\n\n            var available = extension.getQueryObjectEXT(query, extension.QUERY_RESULT_AVAILABLE_EXT);\n\n            var disjoint = _this7.gl.getParameter(extension.GPU_DISJOINT_EXT);\n\n            if (available && !disjoint) {\n              var result = {\n                wasValid: wasValid,\n                fragment: fragmentString || _this7.fragmentString,\n                vertex: vertexString || _this7.vertexString,\n                timeElapsedMs: extension.getQueryObjectEXT(query, extension.QUERY_RESULT_EXT) / 1000000.0\n              };\n              _this7.timer.paused = paused;\n\n              if (fragmentString || vertexString) {\n                _this7.load(fragment, vertex);\n              }\n\n              resolve(result);\n            } else {\n              window.requestAnimationFrame(waitForTest);\n            }\n          };\n\n          waitForTest();\n        });\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this._removeListeners();\n\n        this.animated = false;\n        this.valid = false;\n        var gl = this.gl;\n        gl.useProgram(null);\n        gl.deleteProgram(this.program);\n\n        for (var key in this.buffers.values) {\n          var buffer = this.buffers.values[key];\n          buffer.destroy(gl);\n        }\n\n        for (var _key2 in this.textures.values) {\n          var texture = this.textures.values[_key2];\n          texture.destroy(gl);\n        }\n\n        this.buffers = null;\n        this.textures = null;\n        this.uniforms = null;\n        this.program = null;\n        this.gl = null;\n        GlslCanvas.items.splice(GlslCanvas.items.indexOf(this), 1);\n      }\n    }, {\n      key: \"loadTexture\",\n      value: function loadTexture(key, urlElementOrData) {\n        var _this8 = this;\n\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n        if (this.valid) {\n          return this.textures.createOrUpdate(this.gl, key, urlElementOrData, this.buffers.count, options).then(function (texture) {\n            var index = texture.index;\n\n            var uniform = _this8.uniforms.createTexture(key, index);\n\n            uniform.texture = texture;\n            var keyResolution = key.indexOf('[') !== -1 ? key.replace('[', 'Resolution[') : key + 'Resolution';\n\n            var uniformResolution = _this8.uniforms.create(uniforms_1.UniformMethod.Uniform2f, uniforms_1.UniformType.FloatVec2, keyResolution, texture.width, texture.height); // console.log('loadTexture', key, url, index, texture.width, texture.height);\n\n\n            return texture;\n          });\n        } else {\n          this.textureList.push({\n            key: key,\n            url: urlElementOrData\n          });\n        }\n      }\n    }, {\n      key: \"setTexture\",\n      value: function setTexture(key, urlElementOrData) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        return this._setUniform(key, [urlElementOrData], options);\n      }\n    }, {\n      key: \"setUniform\",\n      value: function setUniform(key) {\n        for (var _len = arguments.length, values = new Array(_len > 1 ? _len - 1 : 0), _key3 = 1; _key3 < _len; _key3++) {\n          values[_key3 - 1] = arguments[_key3];\n        }\n\n        return this._setUniform(key, values);\n      }\n    }, {\n      key: \"setUniformOfInt\",\n      value: function setUniformOfInt(key, values) {\n        return this._setUniform(key, values, null, uniforms_1.UniformType.Int);\n      }\n    }, {\n      key: \"setUniforms\",\n      value: function setUniforms(values) {\n        for (var key in values) {\n          this.setUniform(key, values[key]);\n        }\n      }\n    }, {\n      key: \"pause\",\n      value: function pause() {\n        if (this.valid) {\n          this.timer.pause();\n          this.canvas.classList.add('paused');\n          this.trigger('pause');\n        }\n      }\n    }, {\n      key: \"play\",\n      value: function play() {\n        if (this.valid) {\n          this.timer.play();\n          this.canvas.classList.remove('paused');\n          this.trigger('play');\n        }\n      }\n    }, {\n      key: \"toggle\",\n      value: function toggle() {\n        if (this.valid) {\n          if (this.timer.paused) {\n            this.play();\n          } else {\n            this.pause();\n          }\n        }\n      }\n    }, {\n      key: \"checkRender\",\n      value: function checkRender() {\n        if (this._isVisible() && (this._sizeDidChanged() || this._isAnimated() || this._isDirty())) {\n          this.render();\n          this.canvas.classList.add('playing');\n        } else {\n          this.canvas.classList.remove('playing');\n        }\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var gl = this.gl;\n        var BW = gl.drawingBufferWidth;\n        var BH = gl.drawingBufferHeight;\n\n        this._updateUniforms();\n\n        for (var key in this.buffers.values) {\n          var buffer = this.buffers.values[key];\n          this.uniforms.apply(gl, buffer.program);\n          buffer.render(gl, BW, BH);\n        }\n\n        gl.useProgram(this.program);\n        this.uniforms.apply(gl, this.program);\n        gl.viewport(0, 0, BW, BH);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\n        this.uniforms.clean();\n        this.textures.clean();\n        this.dirty = false;\n        this.trigger('render', this);\n      }\n    }], [{\n      key: \"version\",\n      value: function version() {\n        return '0.2.0';\n      }\n    }, {\n      key: \"of\",\n      value: function of(canvas) {\n        return GlslCanvas.items.find(function (x) {\n          return x.canvas === canvas;\n        }) || new GlslCanvas(canvas);\n      }\n    }, {\n      key: \"loadAll\",\n      value: function loadAll() {\n        var canvases = [].slice.call(document.getElementsByClassName('glsl-canvas')).filter(function (x) {\n          return x instanceof HTMLCanvasElement;\n        });\n        return canvases.map(function (x) {\n          return GlslCanvas.of(x);\n        });\n      }\n    }]);\n\n    return GlslCanvas;\n  }(subscriber_1.default);\n\n  GlslCanvas.items = [];\n  exports.default = GlslCanvas;\n  window.GlslCanvas = window.GlslCanvas || GlslCanvas; // (<any>(window)).GlslCanvas = GlslCanvas;\n\n  if (document) {\n    document.addEventListener(\"DOMContentLoaded\", function () {\n      GlslCanvas.loadAll();\n    });\n  }\n});\n\n},{\"./buffers\":4,\"./common\":5,\"./context\":6,\"./subscriber\":9,\"./textures\":10,\"./uniforms\":11,\"promise-polyfill\":2}],8:[function(require,module,exports){\n\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var NumberMap = function NumberMap() {\n    _classCallCheck(this, NumberMap);\n  };\n\n  exports.NumberMap = NumberMap;\n  ;\n\n  var StringMap = function StringMap() {\n    _classCallCheck(this, StringMap);\n  };\n\n  exports.StringMap = StringMap;\n  ;\n\n  var IterableStringMap =\n  /*#__PURE__*/\n  function () {\n    function IterableStringMap() {\n      _classCallCheck(this, IterableStringMap);\n\n      this.values = new StringMap();\n    }\n\n    _createClass(IterableStringMap, [{\n      key: \"has\",\n      value: function has(key) {\n        return this.values.hasOwnProperty(key);\n      }\n    }, {\n      key: \"set\",\n      value: function set(key, item) {\n        this.values[key] = item;\n      }\n    }, {\n      key: \"get\",\n      value: function get(key) {\n        return this.values[key];\n      }\n    }, {\n      key: \"forEach\",\n      value: function forEach(callbackfn) {\n        var i = 0;\n\n        for (var key in this.values) {\n          callbackfn(this.values[key], i, this.values);\n          i++;\n        }\n      }\n    }, {\n      key: \"reduce\",\n      value: function reduce(callbackfn, initialValue) {\n        var previous = initialValue,\n            i = 0;\n\n        for (var key in this.values) {\n          previous = callbackfn(previous, this.values[key], i, this.values);\n          i++;\n        }\n\n        return previous;\n      }\n    }]);\n\n    return IterableStringMap;\n  }();\n\n  exports.default = IterableStringMap;\n});\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var Listener = function Listener(event, callback) {\n    _classCallCheck(this, Listener);\n\n    this.event = event;\n    this.callback = callback;\n  };\n\n  exports.Listener = Listener;\n\n  var Subscriber =\n  /*#__PURE__*/\n  function () {\n    function Subscriber() {\n      _classCallCheck(this, Subscriber);\n\n      this.listeners = new Set();\n    }\n\n    _createClass(Subscriber, [{\n      key: \"logListeners\",\n      value: function logListeners() {\n        this.listeners.forEach(function (x) {\n          return console.log(x);\n        });\n      }\n    }, {\n      key: \"subscribe\",\n      value: function subscribe(listener) {\n        this.listeners.add(listener);\n      }\n    }, {\n      key: \"unsubscribe\",\n      value: function unsubscribe(listener) {\n        this.listeners.delete(listener);\n      }\n    }, {\n      key: \"unsubscribeAll\",\n      value: function unsubscribeAll() {\n        this.listeners.clear();\n      }\n    }, {\n      key: \"on\",\n      value: function on(event, callback) {\n        this.listeners.add(new Listener(event, callback));\n        return this;\n      }\n    }, {\n      key: \"off\",\n      value: function off(event, callback) {\n        var _this = this;\n\n        if (callback) {\n          this.listeners.delete(new Listener(event, callback));\n        } else {\n          this.listeners.forEach(function (x) {\n            if (x.event === event) {\n              _this.listeners.delete(x);\n            }\n          });\n        }\n\n        return this;\n      }\n    }, {\n      key: \"trigger\",\n      value: function trigger(event) {\n        for (var _len = arguments.length, data = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          data[_key - 1] = arguments[_key];\n        }\n\n        this.listeners.forEach(function (x) {\n          if (x.event === event && typeof x.callback === 'function') {\n            x.callback.apply(x, data);\n          }\n        });\n        return this;\n      }\n    }]);\n\n    return Subscriber;\n  }();\n\n  exports.default = Subscriber;\n});\n\n},{}],10:[function(require,module,exports){\n\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"./iterable\", \"./subscriber\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  }); // import 'promise-polyfill';\n\n  var iterable_1 = __importDefault(require(\"./iterable\"));\n\n  var subscriber_1 = __importDefault(require(\"./subscriber\"));\n\n  exports.TextureImageExtensions = ['jpg', 'jpeg', 'png'];\n  exports.TextureVideoExtensions = ['ogv', 'webm', 'mp4'];\n  exports.TextureExtensions = exports.TextureImageExtensions.concat(exports.TextureVideoExtensions);\n  var TextureSourceType;\n\n  (function (TextureSourceType) {\n    TextureSourceType[TextureSourceType[\"Data\"] = 0] = \"Data\";\n    TextureSourceType[TextureSourceType[\"Element\"] = 1] = \"Element\";\n    TextureSourceType[TextureSourceType[\"Url\"] = 2] = \"Url\";\n  })(TextureSourceType || (TextureSourceType = {}));\n\n  var TextureFilteringType;\n\n  (function (TextureFilteringType) {\n    TextureFilteringType[\"MipMap\"] = \"mipmap\";\n    TextureFilteringType[\"Linear\"] = \"linear\";\n    TextureFilteringType[\"Nearest\"] = \"nearest\";\n  })(TextureFilteringType || (TextureFilteringType = {}));\n\n  var TextureData = function TextureData() {\n    _classCallCheck(this, TextureData);\n  };\n\n  exports.TextureData = TextureData;\n\n  var TextureOptions = function TextureOptions() {\n    _classCallCheck(this, TextureOptions);\n  };\n\n  exports.TextureOptions = TextureOptions; // GL texture wrapper object for keeping track of a global set of textures, keyed by a unique user-defined name\n\n  var Texture =\n  /*#__PURE__*/\n  function (_subscriber_1$default) {\n    _inherits(Texture, _subscriber_1$default);\n\n    function Texture(gl, key, index) {\n      var _this;\n\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new TextureOptions();\n      var workpath = arguments.length > 4 ? arguments[4] : undefined;\n\n      _classCallCheck(this, Texture);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(Texture).call(this));\n      _this.valid = false;\n      _this.dirty = false;\n      _this.animated = false;\n      _this.powerOf2 = false;\n      _this.key = key;\n      _this.index = index;\n      _this.options = options;\n      _this.workpath = workpath;\n\n      _this.create(gl);\n\n      return _this;\n    }\n\n    _createClass(Texture, [{\n      key: \"create\",\n      value: function create(gl) {\n        this.texture = gl.createTexture();\n\n        if (this.texture) {\n          this.valid = true;\n        } // Default to a 1-pixel black texture so we can safely render while we wait for an image to load\n        // See: http://stackoverflow.com/questions/19722247/webgl-wait-for-texture-to-load\n        // [255, 255, 255, 255]\n\n\n        this.setData(gl, 1, 1, new Uint8Array([0, 0, 0, 0]), {\n          filtering: TextureFilteringType.Linear\n        }); // this.bindTexture();\n        // this.load(options);\n      }\n    }, {\n      key: \"load\",\n      value: function load(gl) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        this.options = options;\n\n        if (typeof options.url === 'string') {\n          if (this.url === undefined || options.url !== this.url) {\n            return this.setUrl(gl, options.url, options);\n          } else {\n            return Promise.resolve(this);\n          }\n        } else if (options.element) {\n          return this.setElement(gl, options.element, options);\n        } else if (options.data && options.width && options.height) {\n          return this.setData(gl, options.width, options.height, options.data, options);\n        }\n      }\n    }, {\n      key: \"setUrl\",\n      value: function setUrl(gl, url) {\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n        if (!this.valid) {\n          return;\n        }\n\n        this.url = url; // save URL reference (will be overwritten when element is loaded below)\n\n        this.source = url;\n        this.sourceType = TextureSourceType.Url;\n        this.options = Object.assign(this.options, options);\n        var src = url.indexOf(':/') === -1 && this.workpath ? \"\".concat(this.workpath, \"/\").concat(url) : url;\n        var ext = url.split('.').pop().toLowerCase();\n        var isVideo = exports.TextureVideoExtensions.indexOf(ext) !== -1;\n        var element;\n        var promise;\n\n        if (isVideo) {\n          element = document.createElement('video'); // options.filtering = TextureFilteringType.Nearest;\n\n          promise = this.setElement(gl, element, options);\n          element.setAttribute('playsinline', 'true');\n          element.autoplay = true;\n          element.muted = true;\n          element.src = src;\n        } else {\n          element = new Image();\n          promise = this.setElement(gl, element, options);\n\n          if (!(Texture.isSafari() && url.slice(0, 5) === 'data:')) {\n            element.crossOrigin = 'anonymous';\n          }\n\n          element.src = src;\n        }\n\n        return promise;\n      }\n    }, {\n      key: \"setElement\",\n      value: function setElement(gl, element) {\n        var _this2 = this;\n\n        var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n        this.options = Object.assign(this.options, options);\n        return new Promise(function (resolve, reject) {\n          var originalElement = element; // a string element is interpeted as a CSS selector\n\n          if (typeof element === 'string') {\n            element = document.querySelector(element);\n          }\n\n          if (element instanceof HTMLCanvasElement || element instanceof HTMLImageElement || element instanceof HTMLVideoElement) {\n            _this2.source = element;\n            _this2.sourceType = TextureSourceType.Element;\n\n            if (element instanceof HTMLVideoElement) {\n              var video = element;\n              video.addEventListener('loadeddata', function (event) {\n                _this2.update(gl, options);\n\n                _this2.setFiltering(gl, options);\n\n                resolve(_this2);\n              });\n              video.addEventListener('error', function (error) {\n                reject(error);\n              });\n            } else if (element instanceof HTMLImageElement) {\n              element.addEventListener('load', function () {\n                _this2.update(gl, options);\n\n                _this2.setFiltering(gl, options);\n\n                resolve(_this2);\n              });\n              element.addEventListener('error', function (error) {\n                reject(error);\n              });\n            } else {\n              _this2.update(gl, options);\n\n              _this2.setFiltering(gl, options);\n\n              resolve(_this2);\n            }\n          } else {\n            var message = \"the 'element' parameter (`element: \".concat(JSON.stringify(originalElement), \"`) must be a CSS selector string, or a <canvas>, <image> or <video> object\");\n            console.log(\"Texture '\".concat(_this2.key, \"': \").concat(message), options);\n            reject(message);\n          }\n        });\n      }\n    }, {\n      key: \"setData\",\n      value: function setData(gl, width, height, data) {\n        var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n        this.width = width;\n        this.height = height;\n        this.options = Object.assign(this.options, options);\n        this.source = data;\n        this.sourceType = TextureSourceType.Data;\n        this.update(gl, options);\n        this.setFiltering(gl, options);\n        return Promise.resolve(this);\n      } // Uploads current image or buffer to the GPU (can be used to update animated textures on the fly)\n\n    }, {\n      key: \"update\",\n      value: function update(gl, options) {\n        if (!this.valid) {\n          return;\n        }\n\n        gl.activeTexture(gl.TEXTURE0 + this.index);\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, options.UNPACK_FLIP_Y_WEBGL === false ? 0 : 1);\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, options.UNPACK_PREMULTIPLY_ALPHA_WEBGL || 0);\n\n        if (this.sourceType === TextureSourceType.Element) {\n          if (this.source instanceof HTMLImageElement && this.source.naturalWidth && this.source.naturalHeight) {\n            this.width = this.source.naturalWidth;\n            this.height = this.source.naturalHeight;\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.source);\n          } else if (this.source instanceof HTMLVideoElement && this.source.videoWidth && this.source.videoHeight) {\n            this.width = this.source.videoWidth;\n            this.height = this.source.videoHeight;\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.source);\n          } else if (this.source instanceof HTMLCanvasElement) {\n            this.width = this.source.width;\n            this.height = this.source.height;\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.source);\n          }\n        } else if (this.sourceType === TextureSourceType.Data) {\n          var imageBuffer = this.source;\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, imageBuffer);\n        }\n\n        this.trigger('loaded', this);\n      }\n    }, {\n      key: \"tryUpdate\",\n      value: function tryUpdate(gl) {\n        var dirty = false;\n\n        if (this.animated) {\n          dirty = true;\n          this.update(gl, this.options);\n        }\n\n        return dirty;\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy(gl) {\n        if (!this.valid) {\n          return;\n        }\n\n        gl.deleteTexture(this.texture);\n        this.texture = null;\n        delete this.source;\n        this.source = null;\n        this.valid = false;\n      }\n    }, {\n      key: \"setFiltering\",\n      value: function setFiltering(gl, options) {\n        if (!this.valid) {\n          return;\n        }\n\n        var powerOf2 = Texture.isPowerOf2(this.width) && Texture.isPowerOf2(this.height);\n        var filtering = options.filtering || TextureFilteringType.MipMap;\n        var wrapS = options.TEXTURE_WRAP_S || options.repeat && gl.REPEAT || gl.CLAMP_TO_EDGE;\n        var wrapT = options.TEXTURE_WRAP_T || options.repeat && gl.REPEAT || gl.CLAMP_TO_EDGE;\n\n        if (!powerOf2) {\n          filtering = filtering === TextureFilteringType.MipMap ? TextureFilteringType.Linear : filtering;\n          wrapS = wrapT = gl.CLAMP_TO_EDGE;\n        }\n\n        this.powerOf2 = powerOf2;\n        this.filtering = filtering; // this.bindTexture();\n        // WebGL has strict requirements on non-power-of-2 textures:\n        // No mipmaps and must clamp to edge\n        // For power-of-2 textures, the following presets are available:\n        // mipmap: linear blend from nearest mip\n        // linear: linear blend from original image (no mips)\n        // nearest: nearest pixel from original image (no mips, 'blocky' look)\n\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT);\n\n        if (this.filtering === TextureFilteringType.MipMap) {\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR); // TODO: use trilinear filtering by defualt instead?\n\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n          gl.generateMipmap(gl.TEXTURE_2D);\n        } else if (this.filtering === TextureFilteringType.Nearest) {\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        } else if (this.filtering === TextureFilteringType.Linear) {\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        }\n      }\n    }], [{\n      key: \"isPowerOf2\",\n      value: function isPowerOf2(value) {\n        return (value & value - 1) === 0;\n      }\n    }, {\n      key: \"isSafari\",\n      value: function isSafari() {\n        return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n      }\n    }, {\n      key: \"isTextureUrl\",\n      value: function isTextureUrl(text) {\n        return /\\.(jpg|jpeg|png|ogv|webm|mp4)$/i.test(text);\n      }\n    }, {\n      key: \"isTexture\",\n      value: function isTexture(urlElementOrData) {\n        var options = Texture.getTextureOptions(urlElementOrData);\n        return options !== undefined;\n      }\n    }, {\n      key: \"getMaxTextureSize\",\n      value: function getMaxTextureSize(gl) {\n        return gl.getParameter(gl.MAX_TEXTURE_SIZE);\n      }\n    }, {\n      key: \"getTextureOptions\",\n      value: function getTextureOptions(urlElementOrData) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        if (typeof urlElementOrData === 'string') {\n          if (Texture.isTextureUrl(urlElementOrData)) {\n            options.url = urlElementOrData;\n            return options;\n          }\n\n          if (document) {\n            urlElementOrData = document.querySelector(urlElementOrData); // console.log(urlElementOrData);\n          }\n        }\n\n        if (urlElementOrData instanceof HTMLCanvasElement || urlElementOrData instanceof HTMLImageElement || urlElementOrData instanceof HTMLVideoElement) {\n          options.element = urlElementOrData;\n          return options;\n        } else if (urlElementOrData instanceof TextureData) {\n          options.data = urlElementOrData.data;\n          options.width = urlElementOrData.width;\n          options.height = urlElementOrData.height;\n          return options;\n        }\n      }\n    }]);\n\n    return Texture;\n  }(subscriber_1.default);\n\n  exports.Texture = Texture;\n\n  var Textures =\n  /*#__PURE__*/\n  function (_iterable_1$default) {\n    _inherits(Textures, _iterable_1$default);\n\n    function Textures() {\n      var _this3;\n\n      _classCallCheck(this, Textures);\n\n      _this3 = _possibleConstructorReturn(this, _getPrototypeOf(Textures).apply(this, arguments));\n      _this3.count = 0;\n      _this3.dirty = false;\n      _this3.animated = false;\n      return _this3;\n    }\n\n    _createClass(Textures, [{\n      key: \"clean\",\n      value: function clean() {\n        for (var key in this.values) {\n          this.values[key].dirty = false;\n        }\n\n        this.dirty = false;\n      }\n    }, {\n      key: \"createOrUpdate\",\n      value: function createOrUpdate(gl, key, urlElementOrData) {\n        var _this4 = this;\n\n        var index = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n        var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n        var texture;\n        var textureOptions = Texture.getTextureOptions(urlElementOrData, options);\n        texture = this.get(key);\n\n        if (!texture) {\n          texture = new Texture(gl, key, index + this.count, textureOptions);\n          this.count++;\n          this.set(key, texture);\n        }\n\n        if (textureOptions !== undefined) {\n          return texture.load(gl, textureOptions).then(function (texture) {\n            if (texture.source instanceof HTMLVideoElement) {\n              var video = texture.source; // console.log('video', video);\n\n              video.addEventListener('play', function () {\n                // console.log('play', texture.key);\n                texture.animated = true;\n                _this4.animated = true;\n              });\n              video.addEventListener('pause', function () {\n                // console.log('pause', texture.key);\n                texture.animated = false;\n                _this4.animated = _this4.reduce(function (flag, texture) {\n                  return flag || texture.animated;\n                }, false);\n              });\n              video.addEventListener('seeked', function () {\n                // console.log('seeked');\n                texture.update(gl, texture.options);\n                _this4.dirty = true;\n              }); // console.log('video');\n\n              /*\n              video.addEventListener('canplaythrough', () => {\n                  // !!!\n                  this.intervalID = setInterval(() => {\n                      this.update(gl, options);\n                  }, 15);\n              }, true);\n              video.addEventListener('ended', () => {\n                  video.currentTime = 0;\n                  video.play();\n              }, true);\n              */\n            }\n\n            return texture;\n          });\n        } else {\n          return Promise.resolve(texture);\n        }\n      }\n    }]);\n\n    return Textures;\n  }(iterable_1.default);\n\n  exports.default = Textures;\n});\n\n},{\"./iterable\":8,\"./subscriber\":9}],11:[function(require,module,exports){\n\"use strict\";\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar __importDefault = void 0 && (void 0).__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\n(function (factory) {\n  if ((typeof module === \"undefined\" ? \"undefined\" : _typeof(module)) === \"object\" && _typeof(module.exports) === \"object\") {\n    var v = factory(require, exports);\n    if (v !== undefined) module.exports = v;\n  } else if (typeof define === \"function\" && define.amd) {\n    define([\"require\", \"exports\", \"./iterable\", \"./textures\"], factory);\n  }\n})(function (require, exports) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var iterable_1 = __importDefault(require(\"./iterable\"));\n\n  var textures_1 = require(\"./textures\");\n\n  var UniformMethod;\n\n  (function (UniformMethod) {\n    UniformMethod[\"Uniform1i\"] = \"uniform1i\"; // Uniform1i  = 'uniform1i', // (boolUniformLoc,   v);                // for bool\n    // Uniform1i  = 'uniform1i', // (sampler2DUniformLoc,   v);           // for sampler2D\n    // Uniform1i  = 'uniform1i', // (samplerCubeUniformLoc,   v);         // for samplerCube\n\n    UniformMethod[\"Uniform2i\"] = \"uniform2i\";\n    UniformMethod[\"Uniform3i\"] = \"uniform3i\";\n    UniformMethod[\"Uniform4i\"] = \"uniform4i\";\n    UniformMethod[\"Uniform1f\"] = \"uniform1f\";\n    UniformMethod[\"Uniform2f\"] = \"uniform2f\";\n    UniformMethod[\"Uniform3f\"] = \"uniform3f\";\n    UniformMethod[\"Uniform4f\"] = \"uniform4f\"; //\n\n    UniformMethod[\"Uniform1iv\"] = \"uniform1iv\"; // Uniform1iv = 'uniform1iv', // (boolUniformLoc, [v]);                // for bool or bool array\n    // Uniform1iv = 'uniform1iv', // (sampler2DUniformLoc, [v]);           // for sampler2D or sampler2D array\n    // Uniform1iv = 'uniform1iv', // (samplerCubeUniformLoc, [v]);         // for samplerCube or samplerCube array\n\n    UniformMethod[\"Uniform2iv\"] = \"uniform2iv\";\n    UniformMethod[\"Uniform3iv\"] = \"uniform3iv\";\n    UniformMethod[\"Uniform4iv\"] = \"uniform4iv\"; //\n\n    UniformMethod[\"Uniform1fv\"] = \"uniform1fv\";\n    UniformMethod[\"Uniform2fv\"] = \"uniform2fv\";\n    UniformMethod[\"Uniform3fv\"] = \"uniform3fv\";\n    UniformMethod[\"Uniform4fv\"] = \"uniform4fv\"; //\n\n    UniformMethod[\"UniformMatrix2fv\"] = \"uniformMatrix2fv\";\n    UniformMethod[\"UniformMatrix3fv\"] = \"uniformMatrix3fv\";\n    UniformMethod[\"UniformMatrix4fv\"] = \"uniformMatrix4fv\";\n  })(UniformMethod = exports.UniformMethod || (exports.UniformMethod = {}));\n\n  var UniformType;\n\n  (function (UniformType) {\n    UniformType[UniformType[\"Int\"] = 0] = \"Int\";\n    UniformType[UniformType[\"IntArray\"] = 1] = \"IntArray\";\n    UniformType[UniformType[\"IntVec2\"] = 2] = \"IntVec2\";\n    UniformType[UniformType[\"IntVec2Array\"] = 3] = \"IntVec2Array\";\n    UniformType[UniformType[\"IntVec3\"] = 4] = \"IntVec3\";\n    UniformType[UniformType[\"IntVec3Array\"] = 5] = \"IntVec3Array\";\n    UniformType[UniformType[\"IntVec4\"] = 6] = \"IntVec4\";\n    UniformType[UniformType[\"IntVec4Array\"] = 7] = \"IntVec4Array\";\n    UniformType[UniformType[\"Float\"] = 8] = \"Float\";\n    UniformType[UniformType[\"FloatArray\"] = 9] = \"FloatArray\";\n    UniformType[UniformType[\"FloatVec2\"] = 10] = \"FloatVec2\";\n    UniformType[UniformType[\"FloatVec2Array\"] = 11] = \"FloatVec2Array\";\n    UniformType[UniformType[\"FloatVec3\"] = 12] = \"FloatVec3\";\n    UniformType[UniformType[\"FloatVec3Array\"] = 13] = \"FloatVec3Array\";\n    UniformType[UniformType[\"FloatVec4\"] = 14] = \"FloatVec4\";\n    UniformType[UniformType[\"FloatVec4Array\"] = 15] = \"FloatVec4Array\";\n    UniformType[UniformType[\"Bool\"] = 16] = \"Bool\";\n    UniformType[UniformType[\"BoolArray\"] = 17] = \"BoolArray\";\n    UniformType[UniformType[\"BoolVec2\"] = 18] = \"BoolVec2\";\n    UniformType[UniformType[\"BoolVec2Array\"] = 19] = \"BoolVec2Array\";\n    UniformType[UniformType[\"BoolVec3\"] = 20] = \"BoolVec3\";\n    UniformType[UniformType[\"BoolVec3Array\"] = 21] = \"BoolVec3Array\";\n    UniformType[UniformType[\"BoolVec4\"] = 22] = \"BoolVec4\";\n    UniformType[UniformType[\"BoolVec4Array\"] = 23] = \"BoolVec4Array\";\n    UniformType[UniformType[\"Sampler2D\"] = 24] = \"Sampler2D\";\n    UniformType[UniformType[\"Sampler2DArray\"] = 25] = \"Sampler2DArray\";\n    UniformType[UniformType[\"SamplerCube\"] = 26] = \"SamplerCube\";\n    UniformType[UniformType[\"SamplerCubeArray\"] = 27] = \"SamplerCubeArray\";\n    UniformType[UniformType[\"Matrix2fv\"] = 28] = \"Matrix2fv\";\n    UniformType[UniformType[\"Matrix3fv\"] = 29] = \"Matrix3fv\";\n    UniformType[UniformType[\"Matrix4fv\"] = 30] = \"Matrix4fv\";\n  })(UniformType = exports.UniformType || (exports.UniformType = {}));\n\n  var Uniform =\n  /*#__PURE__*/\n  function () {\n    function Uniform(options) {\n      var _this = this;\n\n      _classCallCheck(this, Uniform);\n\n      this.dirty = true;\n\n      if (options) {\n        Object.assign(this, options);\n      }\n\n      this.apply = function (gl, program) {\n        if (_this.dirty) {\n          gl.useProgram(program);\n          var location = gl.getUniformLocation(program, _this.key); // console.log(this.key, this.method, this.values);\n          // (gl as any)[this.method].apply(gl, [location].concat(this.values));\n\n          gl[_this.method].apply(gl, [location].concat(_this.values));\n        }\n      };\n    }\n\n    _createClass(Uniform, null, [{\n      key: \"Differs\",\n      value: function Differs(a, b) {\n        return a.length !== b.length || a.reduce(function (f, v, i) {\n          return f || v !== b[i];\n        }, false);\n      }\n    }]);\n\n    return Uniform;\n  }();\n\n  exports.Uniform = Uniform;\n\n  var UniformTexture =\n  /*#__PURE__*/\n  function (_Uniform) {\n    _inherits(UniformTexture, _Uniform);\n\n    function UniformTexture(options) {\n      _classCallCheck(this, UniformTexture);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(UniformTexture).call(this, options));\n    }\n\n    return UniformTexture;\n  }(Uniform);\n\n  exports.UniformTexture = UniformTexture;\n\n  var Uniforms =\n  /*#__PURE__*/\n  function (_iterable_1$default) {\n    _inherits(Uniforms, _iterable_1$default);\n\n    function Uniforms() {\n      var _this2;\n\n      _classCallCheck(this, Uniforms);\n\n      _this2 = _possibleConstructorReturn(this, _getPrototypeOf(Uniforms).apply(this, arguments));\n      _this2.dirty = false;\n      return _this2;\n    }\n\n    _createClass(Uniforms, [{\n      key: \"clean\",\n\n      /*\n      static parseUniforms(values: any, prefix?: string): Map<string, Uniform> {\n          const uniforms = new Map<string, Uniform>();\n          for (let key in values) {\n              const value = values[key];\n              if (prefix) {\n                  key = prefix + '.' + key;\n              }\n              const uniform: Uniform = Uniforms.parseUniform(key, value);\n              if (uniform) {\n                  uniforms.set(key, uniform);\n              }\n          }\n          return uniforms;\n      }\n      */\n      value: function clean() {\n        for (var key in this.values) {\n          this.values[key].dirty = false;\n        }\n\n        this.dirty = false;\n      }\n      /*\n      setParse(key: string, ...values: any[]): Uniform {\n          const uniform: Uniform = Uniforms.parseUniform(key, ...values);\n          if (uniform) {\n              this.set(key, uniform);\n          }\n          return uniform;\n      }\n      */\n\n    }, {\n      key: \"create\",\n      value: function create(method, type, key) {\n        for (var _len = arguments.length, values = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n          values[_key - 3] = arguments[_key];\n        }\n\n        var uniform = new Uniform({\n          method: method,\n          type: type,\n          key: key,\n          values: values\n        });\n        this.set(key, uniform);\n        this.dirty = true;\n        return uniform;\n      }\n    }, {\n      key: \"createTexture\",\n      value: function createTexture(key, index) {\n        var uniform;\n\n        if (key.indexOf(']') !== -1) {\n          uniform = new UniformTexture({\n            method: UniformMethod.Uniform1iv,\n            type: UniformType.Sampler2DArray,\n            key: key,\n            values: [[index]]\n          });\n        } else {\n          uniform = new UniformTexture({\n            method: UniformMethod.Uniform1i,\n            type: UniformType.Sampler2D,\n            key: key,\n            values: [index]\n          });\n        }\n\n        this.set(key, uniform);\n        this.dirty = true;\n        return uniform;\n      }\n    }, {\n      key: \"update\",\n      value: function update(method, type, key) {\n        var uniform = this.get(key);\n\n        for (var _len2 = arguments.length, values = new Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {\n          values[_key2 - 3] = arguments[_key2];\n        }\n\n        if (uniform && (uniform.method !== method || uniform.type !== type || Uniform.Differs(uniform.values, values))) {\n          uniform.method = method;\n          uniform.type = type;\n          uniform.values = values;\n          uniform.dirty = true;\n          this.dirty = true;\n        }\n      }\n    }, {\n      key: \"createOrUpdate\",\n      value: function createOrUpdate(method, type, key) {\n        for (var _len3 = arguments.length, values = new Array(_len3 > 3 ? _len3 - 3 : 0), _key3 = 3; _key3 < _len3; _key3++) {\n          values[_key3 - 3] = arguments[_key3];\n        }\n\n        if (this.has(key)) {\n          this.update.apply(this, [method, type, key].concat(values));\n        } else {\n          this.create.apply(this, [method, type, key].concat(values));\n        }\n      }\n    }, {\n      key: \"apply\",\n      value: function apply(gl, program) {\n        for (var key in this.values) {\n          // if (typeof this.values[key].apply === 'function') {\n          this.values[key].apply(gl, program); // }\n        } // this.forEach(uniform => uniform.apply(gl, program));\n\n      }\n    }], [{\n      key: \"isArrayOfInteger\",\n      value: function isArrayOfInteger(array) {\n        return array.reduce(function (flag, value) {\n          return flag && Number.isInteger(value);\n        }, true);\n      }\n    }, {\n      key: \"isArrayOfNumber\",\n      value: function isArrayOfNumber(array) {\n        return array.reduce(function (flag, value) {\n          return flag && typeof value === 'number';\n        }, true);\n      }\n    }, {\n      key: \"isArrayOfBoolean\",\n      value: function isArrayOfBoolean(array) {\n        return array.reduce(function (flag, value) {\n          return flag && typeof value === 'boolean';\n        }, true);\n      }\n    }, {\n      key: \"isArrayOfTexture\",\n      value: function isArrayOfTexture(array) {\n        return array.reduce(function (flag, value) {\n          return flag && textures_1.Texture.isTexture(value);\n        }, true);\n      }\n    }, {\n      key: \"isArrayOfSampler2D\",\n      value: function isArrayOfSampler2D(array) {\n        return array.reduce(function (flag, value) {\n          return flag && value.type === UniformType.Sampler2D;\n        }, true);\n      }\n    }, {\n      key: \"parseUniform\",\n      value: function parseUniform(key) {\n        for (var _len4 = arguments.length, values = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n          values[_key4 - 1] = arguments[_key4];\n        }\n\n        var uniform;\n\n        if (Uniforms.isArrayOfInteger(values)) {\n          switch (values.length) {\n            case 1:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform1i,\n                type: UniformType.Int,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 2:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform2i,\n                type: UniformType.IntVec2,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 3:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform3i,\n                type: UniformType.IntVec3,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 4:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform4i,\n                type: UniformType.IntVec4,\n                key: key,\n                values: values\n              });\n              break;\n          }\n        } else if (Uniforms.isArrayOfNumber(values)) {\n          switch (values.length) {\n            case 1:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform1f,\n                type: UniformType.Float,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 2:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform2f,\n                type: UniformType.FloatVec2,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 3:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform3f,\n                type: UniformType.FloatVec3,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 4:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform4f,\n                type: UniformType.FloatVec4,\n                key: key,\n                values: values\n              });\n              break;\n          }\n        } else if (Uniforms.isArrayOfBoolean(values)) {\n          switch (values.length) {\n            case 1:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform1i,\n                type: UniformType.Bool,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 2:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform2i,\n                type: UniformType.BoolVec2,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 3:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform3i,\n                type: UniformType.BoolVec3,\n                key: key,\n                values: values\n              });\n              break;\n\n            case 4:\n              uniform = new Uniform({\n                method: UniformMethod.Uniform4i,\n                type: UniformType.BoolVec4,\n                key: key,\n                values: values\n              });\n              break;\n          }\n        } else if (values.length === 1) {\n          var value = values[0];\n\n          if (textures_1.Texture.isTexture(value)) {\n            uniform = new Uniform({\n              method: UniformMethod.Uniform1i,\n              type: UniformType.Sampler2D,\n              key: key,\n              values: value // !!!\n\n            });\n          } else if (Array.isArray(value)) {\n            if (Uniforms.isArrayOfInteger(value)) {\n              switch (value.length) {\n                case 1:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform1iv,\n                    type: UniformType.IntArray,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 2:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform2iv,\n                    type: UniformType.IntVec2Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 3:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform3iv,\n                    type: UniformType.IntVec3Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 4:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform4iv,\n                    type: UniformType.IntVec4Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n              }\n            } else if (Uniforms.isArrayOfNumber(value)) {\n              switch (value.length) {\n                case 1:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform1fv,\n                    type: UniformType.FloatArray,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 2:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform2fv,\n                    type: UniformType.FloatVec2Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 3:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform3fv,\n                    type: UniformType.FloatVec3Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 4:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform4fv,\n                    type: UniformType.FloatVec4Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n              }\n            } else if (Uniforms.isArrayOfBoolean(value)) {\n              switch (value.length) {\n                case 1:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform1iv,\n                    type: UniformType.BoolArray,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 2:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform2i,\n                    type: UniformType.BoolVec2Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 3:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform3i,\n                    type: UniformType.BoolVec3Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n\n                case 4:\n                  uniform = new Uniform({\n                    method: UniformMethod.Uniform4i,\n                    type: UniformType.BoolVec4Array,\n                    key: key,\n                    values: values\n                  });\n                  break;\n              }\n            } else if (Uniforms.isArrayOfTexture(value)) {\n              var uniforms = value.map(function (texture, index) {\n                return new Uniform({\n                  method: UniformMethod.Uniform1iv,\n                  type: UniformType.Sampler2DArray,\n                  key: key + '[' + index + ']',\n                  values: [texture]\n                });\n              });\n              return uniforms;\n            }\n          }\n        }\n        /*\n            } else if (Array.isArray(value[0]) && typeof value[0][0] === 'number') {\n                // Array of arrays - but only arrays of vectors are allowed in this case\n                // float vectors (vec2, vec3, vec4)\n                if (value[0].length >= 2 && value[0].length <= 4) {\n                    // Set each vector in the array\n                    for (let u = 0; u < value.length; u++) {\n                        switch (value.length) {\n                            case 2:\n                                uniform = new Uniform({\n                                    method: UniformMethod.Uniform2fv,\n                                    type: UniformType.FloatVec2,\n                                    key: key + '[' + u + ']',\n                                    values: value\n                                });\n                                break;\n                            case 3:\n                                uniform = new Uniform({\n                                    method: UniformMethod.Uniform3fv,\n                                    type: UniformType.FloatVec3,\n                                    key: key + '[' + u + ']',\n                                    values: value\n                                });\n                                break;\n                            case 4:\n                                uniform = new Uniform({\n                                    method: UniformMethod.Uniform4fv,\n                                    type: UniformType.FloatVec4,\n                                    key: key + '[' + u + ']',\n                                    values: value\n                                });\n                                break;\n                        }\n                    }\n                }\n                // else error?\n            } else if (typeof value[0] === 'object') {\n                // Array of structures\n                for (let u = 0; u < value.length; u++) {\n                    // Set each struct in the array\n                    // !!! uniform = new Uniform(...Uniforms.parseUniforms(value[u], key + '[' + u + ']'));\n                }\n            }\n        } else if (typeof value === 'object') {\n            // Structure\n            // Set each field in the struct\n            // !!! uniform = new Uniform(...Uniforms.parseUniforms(value, key));\n        }\n        // TODO: support other non-float types? (int, etc.)\n        */\n\n\n        return uniform;\n      }\n    }]);\n\n    return Uniforms;\n  }(iterable_1.default);\n\n  exports.default = Uniforms;\n});\n\n},{\"./iterable\":8,\"./textures\":10}]},{},[7]);\n//# sourceMappingURL=glsl-canvas.js.map\n"]}